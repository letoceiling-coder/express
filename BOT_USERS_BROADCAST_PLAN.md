# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±–æ—Ç–∞ –∏ —Ä–∞—Å—Å—ã–ª–∫–∏

## üìã –¶–µ–ª—å

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è:
1. –í–µ–¥–µ–Ω–∏—è (—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Telegram –±–æ—Ç–∞
2. –†–∞—Å—Å—ã–ª–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π/—Ñ–æ—Ç–æ/–º–µ–¥–∏–∞ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

---

## üóÑÔ∏è –≠—Ç–∞–ø 1: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–∏

### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `telegram_users`

**–§–∞–π–ª:** `database/migrations/YYYY_MM_DD_HHMMSS_create_telegram_users_table.php`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:**
```php
Schema::create('telegram_users', function (Blueprint $table) {
    $table->id();
    $table->unsignedBigInteger('bot_id'); // –°–≤—è–∑—å —Å –±–æ—Ç–æ–º
    $table->unsignedBigInteger('telegram_id')->unique(); // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
    $table->string('first_name')->nullable();
    $table->string('last_name')->nullable();
    $table->string('username')->nullable();
    $table->string('language_code')->nullable();
    $table->boolean('is_premium')->default(false);
    $table->boolean('is_blocked')->default(false); // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    $table->timestamp('last_interaction_at')->nullable(); // –ü–æ—Å–ª–µ–¥–Ω–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
    $table->integer('orders_count')->default(0); // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤
    $table->decimal('total_spent', 10, 2)->default(0); // –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫
    $table->json('metadata')->nullable(); // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    $table->timestamps();
    $table->softDeletes();

    $table->foreign('bot_id')->references('id')->on('bots')->onDelete('cascade');
    $table->index('bot_id');
    $table->index('telegram_id');
    $table->index('is_blocked');
});
```

**–ü–æ–ª—è:**
- `bot_id` - ID –±–æ—Ç–∞ (foreign key –∫ —Ç–∞–±–ª–∏—Ü–µ bots)
- `telegram_id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
- `first_name`, `last_name`, `username` - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
- `language_code` - –Ø–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `is_premium` - –ü—Ä–µ–º–∏—É–º —Å—Ç–∞—Ç—É—Å
- `is_blocked` - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ —Ä–∞—Å—Å—ã–ª–æ–∫)
- `last_interaction_at` - –ü–æ—Å–ª–µ–¥–Ω–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º
- `orders_count` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ (–¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏)
- `total_spent` - –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫ (–¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏)
- `metadata` - JSON –ø–æ–ª–µ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 1.2 –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ TelegramUser

**–§–∞–π–ª:** `app/Models/TelegramUser.php`

**–°–≤—è–∑–∏:**
- `belongsTo(Bot::class)` - —Å–≤—è–∑—å —Å –±–æ—Ç–æ–º
- `hasMany(Order::class, 'telegram_id', 'telegram_id')` - —Å–≤—è–∑—å —Å –∑–∞–∫–∞–∑–∞–º–∏ (—á–µ—Ä–µ–∑ telegram_id)

**Scopes:**
- `active()` - —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ (–Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- `byBot($botId)` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –±–æ—Ç—É
- `recent()` - –Ω–µ–¥–∞–≤–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–≤—à–∏–µ

**–ú–µ—Ç–æ–¥—ã:**
- `getFullNameAttribute()` - –ø–æ–ª–Ω–æ–µ –∏–º—è
- `block()` - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `unblock()` - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `updateInteraction()` - –æ–±–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

### 1.3 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ Bot

**–§–∞–π–ª:** `app/Models/Bot.php`

**–î–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑—å:**
- `hasMany(TelegramUser::class)` - —Å–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±–æ—Ç–∞

---

## üîß –≠—Ç–∞–ø 2: Backend - –°–µ—Ä–≤–∏—Å—ã

### 2.1 –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ TelegramService

**–§–∞–π–ª:** `app/Services/TelegramService.php`

**–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã:**

1. **sendPhoto()** - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ
```php
public function sendPhoto(string $token, int|string $chatId, string $photo, array $options = []): array
```

2. **sendDocument()** - –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```php
public function sendDocument(string $token, int|string $chatId, string $document, array $options = []): array
```

3. **sendMediaGroup()** - –û—Ç–ø—Ä–∞–≤–∫–∞ –≥—Ä—É–ø–ø—ã –º–µ–¥–∏–∞
```php
public function sendMediaGroup(string $token, int|string $chatId, array $media, array $options = []): array
```

4. **getChat()** - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∞—Ç–µ
```php
public function getChat(string $token, int|string $chatId): array
```

### 2.2 –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ TelegramUserService

**–§–∞–π–ª:** `app/Services/Telegram/TelegramUserService.php`

**–ú–µ—Ç–æ–¥—ã:**

1. **syncUser()** - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
```php
public function syncUser(int $botId, array $telegramUserData): TelegramUser
```

2. **updateUserFromTelegram()** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram API
```php
public function updateUserFromTelegram(TelegramUser $user): TelegramUser
```

3. **updateStatistics()** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (orders_count, total_spent)
```php
public function updateStatistics(TelegramUser $user): void
```

### 2.3 –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ BroadcastService

**–§–∞–π–ª:** `app/Services/Telegram/BroadcastService.php`

**–ú–µ—Ç–æ–¥—ã:**

1. **sendBroadcast()** - –†–∞—Å—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è/–º–µ–¥–∏–∞
```php
public function sendBroadcast(
    int $botId,
    array $telegramUserIds,
    string $type, // 'message', 'photo', 'document', 'media_group'
    array $content, // —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    array $options = []
): array // —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—Å—ã–ª–∫–∏ —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
```

2. **sendToAll()** - –†–∞—Å—Å—ã–ª–∫–∞ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ—Ç–∞
```php
public function sendToAll(int $botId, string $type, array $content, array $options = []): array
```

3. **sendToSelected()** - –†–∞—Å—Å—ã–ª–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
```php
public function sendToSelected(int $botId, array $telegramUserIds, string $type, array $content, array $options = []): array
```

**–õ–æ–≥–∏–∫–∞:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å (queues) –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ü–æ–¥—Å—á–µ—Ç —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞ –∏ —Ç.–¥.)

---

## üéÆ –≠—Ç–∞–ø 3: Backend - –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã

### 3.1 –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ TelegramUserController

**–§–∞–π–ª:** `app/Http/Controllers/Api/v1/TelegramUserController.php`

**–ú–µ—Ç–æ–¥—ã:**

1. **index()** - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ—Ç–∞
   - GET `/api/v1/telegram-users?bot_id={id}`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `bot_id`, `search`, `is_blocked`, `sort`, `per_page`
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

2. **show($id)** - –î–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - GET `/api/v1/telegram-users/{id}`
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

3. **update($id)** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - PUT `/api/v1/telegram-users/{id}`
   - –ü–æ–ª—è: `is_blocked`, `metadata`

4. **block($id)** - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - POST `/api/v1/telegram-users/{id}/block`

5. **unblock($id)** - –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - POST `/api/v1/telegram-users/{id}/unblock`

6. **sync($id)** - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Telegram
   - POST `/api/v1/telegram-users/{id}/sync`

7. **statistics($id)** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - GET `/api/v1/telegram-users/{id}/statistics`

### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ BroadcastController

**–§–∞–π–ª:** `app/Http/Controllers/Api/v1/BroadcastController.php`

**–ú–µ—Ç–æ–¥—ã:**

1. **send()** - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏
   - POST `/api/v1/broadcasts/send`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
     ```json
     {
       "bot_id": 1,
       "telegram_user_ids": [123456, 789012], // null –∏–ª–∏ [] = –≤—Å–µ–º
       "type": "message", // "message", "photo", "document", "media_group"
       "content": {
         "text": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
         "photo": "url –∏–ª–∏ file_id",
         "document": "url –∏–ª–∏ file_id",
         "media": [...] // –¥–ª—è media_group
       },
       "options": {
         "parse_mode": "HTML",
         "disable_notification": false
       }
     }
     ```
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ success: true, data: { sent: 10, failed: 2, total: 12 } }`

2. **preview()** - –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å—Å—ã–ª–∫–∏ (–±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏)
   - POST `/api/v1/broadcasts/preview`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ –∂–µ, –Ω–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç

---

## üõ£Ô∏è –≠—Ç–∞–ø 4: Backend - –ú–∞—Ä—à—Ä—É—Ç—ã

**–§–∞–π–ª:** `routes/api.php`

**–î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É `v1` (–∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã):**

```php
// Telegram Users
Route::apiResource('telegram-users', TelegramUserController::class);
Route::post('telegram-users/{id}/block', [TelegramUserController::class, 'block']);
Route::post('telegram-users/{id}/unblock', [TelegramUserController::class, 'unblock']);
Route::post('telegram-users/{id}/sync', [TelegramUserController::class, 'sync']);
Route::get('telegram-users/{id}/statistics', [TelegramUserController::class, 'statistics']);

// Broadcasts
Route::post('broadcasts/send', [BroadcastController::class, 'send']);
Route::post('broadcasts/preview', [BroadcastController::class, 'preview']);
```

### 4.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ webhook –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–§–∞–π–ª:** `app/Http/Controllers/Api/BotController.php`

**–ú–µ—Ç–æ–¥:** `handleWebhook()`

**–î–æ–±–∞–≤–∏—Ç—å:**
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è/–∫–æ–º–∞–Ω–¥—ã - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ TelegramUserService
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å/–æ–±–Ω–æ–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ telegram_users

---

## üé® –≠—Ç–∞–ø 5: Frontend - Vue Admin Panel

### 5.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é

**–§–∞–π–ª:** `app/Services/AdminMenu.php`

**–î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é:**
```php
[
    'title' => '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞',
    'route' => 'admin.telegram-users',
    'icon' => 'users',
    'roles' => ['admin', 'manager'],
],
[
    'title' => '–†–∞—Å—Å—ã–ª–∫–∏',
    'route' => 'admin.broadcasts',
    'icon' => 'send',
    'roles' => ['admin', 'manager'],
],
```

### 5.2 –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ—Ç–∞

**–§–∞–π–ª:** `resources/js/pages/admin/TelegramUsers.vue`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:
  - –ü–æ –±–æ—Ç—É (dropdown —Å –≤—ã–±–æ—Ä–æ–º –±–æ—Ç–∞)
  - –ü–æ –ø–æ–∏—Å–∫—É (first_name, last_name, username, telegram_id)
  - –ü–æ —Å—Ç–∞—Ç—É—Å—É (–≤—Å–µ, –∞–∫—Ç–∏–≤–Ω—ã–µ, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (–ø–æ –¥–∞—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é, –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤)
- –ö–æ–ª–æ–Ω–∫–∏:
  - Telegram ID
  - –ò–º—è (first_name + last_name)
  - Username
  - –ë–æ—Ç
  - –ó–∞–∫–∞–∑–æ–≤
  - –°—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫
  - –°—Ç–∞—Ç—É—Å (–∞–∫—Ç–∏–≤–µ–Ω/–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
  - –ü–æ—Å–ª–µ–¥–Ω–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
  - –î–µ–π—Å—Ç–≤–∏—è (–ø—Ä–æ—Å–º–æ—Ç—Ä, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- –¢–∞–±–ª–∏—Ü–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –§–∏–ª—å—Ç—Ä—ã
- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π

### 5.3 –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ—Ç–∞–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ—Ç–∞

**–§–∞–π–ª:** `resources/js/pages/admin/TelegramUserDetail.vue`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–∑–∞–∫–∞–∑—ã, —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫)
- –ò—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ö–Ω–æ–ø–∫–∏: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 5.4 –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞—Å—Å—ã–ª–æ–∫

**–§–∞–π–ª:** `resources/js/pages/admin/Broadcasts.vue`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

1. **–§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å—Å—ã–ª–∫–∏:**
   - –í—ã–±–æ—Ä –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   - –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Å–æ–æ–±—â–µ–Ω–∏–µ, —Ñ–æ—Ç–æ, –¥–æ–∫—É–º–µ–Ω—Ç, –≥—Ä—É–ø–ø–∞ –º–µ–¥–∏–∞)
   - –ü–æ–ª–µ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Ç–µ–∫—Å—Ç, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤)
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ (parse_mode, disable_notification)
   - –í—ã–±–æ—Ä –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π:
     - –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞
     - –í—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞)
   - –ö–Ω–æ–ø–∫–∞ "–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä"
   - –ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"

2. **–°–ø–∏—Å–æ–∫ —Ä–∞—Å—Å—ã–ª–æ–∫ (–∏—Å—Ç–æ—Ä–∏—è):**
   - –¢–∞–±–ª–∏—Ü–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Ä–∞—Å—Å—ã–ª–æ–∫
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –±–æ—Ç, —Ç–∏–ø, –ø–æ–ª—É—á–∞—Ç–µ–ª–∏, —Å—Ç–∞—Ç—É—Å, —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ/–æ—à–∏–±–æ–∫), –¥–∞—Ç–∞
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—Å—ã–ª–∫–∏

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å—Å—ã–ª–∫–∏
- –°–µ–ª–µ–∫—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä)
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏

### 5.5 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–§–∞–π–ª:** `resources/js/components/admin/TelegramUserSelector.vue`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏/username/telegram_id
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –±–æ—Ç—É
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üîÑ –≠—Ç–∞–ø 6: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### 6.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–°–æ–∑–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É Artisan:**

**–§–∞–π–ª:** `app/Console/Commands/SyncTelegramUsers.php`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã orders
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ telegram_users –¥–ª—è –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö telegram_id –∏–∑ –∑–∞–∫–∞–∑–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (orders_count, total_spent)
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
php artisan telegram:sync-users --bot-id=1
```

### 6.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞

**–§–∞–π–ª:** `app/Http/Controllers/Api/v1/OrderController.php`

**–ú–µ—Ç–æ–¥:** `store()`

**–î–æ–±–∞–≤–∏—Ç—å:**
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ TelegramUserService
- –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üìù –≠—Ç–∞–ø 7: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∑–∞–ø—Ä–æ—Å—ã

### 7.1 Request –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏

**–§–∞–π–ª:** `app/Http/Requests/BroadcastRequest.php`

**–ü—Ä–∞–≤–∏–ª–∞:**
- `bot_id` - required|exists:bots,id
- `telegram_user_ids` - nullable|array
- `telegram_user_ids.*` - integer
- `type` - required|in:message,photo,document,media_group
- `content` - required|array
- `content.text` - required_if:type,message
- `content.photo` - required_if:type,photo
- `content.document` - required_if:type,document
- `options` - nullable|array

### 7.2 Request –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–§–∞–π–ª:** `app/Http/Requests/UpdateTelegramUserRequest.php`

**–ü—Ä–∞–≤–∏–ª–∞:**
- `is_blocked` - nullable|boolean
- `metadata` - nullable|array

---

## üìä –≠—Ç–∞–ø 8: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### 8.1 –ú–æ–¥–µ–ª—å BroadcastLog (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–§–∞–π–ª:** `database/migrations/YYYY_MM_DD_HHMMSS_create_broadcast_logs_table.php`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `id`
- `bot_id`
- `type`
- `content` (JSON)
- `telegram_user_id`
- `status` (sent, failed)
- `error_message` (nullable)
- `sent_at`
- `timestamps`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞—Å—Å—ã–ª–æ–∫
- –ê–Ω–∞–ª–∏–∑ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ —Ä–∞—Å—Å—ã–ª–æ–∫
- –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

---

## üß™ –≠—Ç–∞–ø 9: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 9.1 Unit —Ç–µ—Å—Ç—ã
- TelegramUserService
- BroadcastService
- TelegramService (–Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã)

### 9.2 Feature —Ç–µ—Å—Ç—ã
- TelegramUserController
- BroadcastController

### 9.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∑–∞–∫–∞–∑–µ
- –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å—Å—ã–ª–∫–∏

---

## üìö –≠—Ç–∞–ø 10: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 10.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ APPLICATION_DOCUMENTATION.md

**–î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª—ã:**
- –ú–æ–¥–µ–ª—å TelegramUser
- –°–µ—Ä–≤–∏—Å—ã TelegramUserService –∏ BroadcastService
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã TelegramUserController –∏ BroadcastController
- API endpoints
- –°—Ç—Ä–∞–Ω–∏—Ü—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### 10.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README.md

**–î–æ–±–∞–≤–∏—Ç—å:**
- –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±–æ—Ç–∞
- –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Ä–∞—Å—Å—ã–ª–æ–∫

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram API:**
   - –õ–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É (30 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫—É–Ω–¥—É)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥–∏ (queues) –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫
   - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞ (403 Forbidden)
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω (400 Bad Request)
   - –õ–∏–º–∏—Ç—ã API (429 Too Many Requests)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–º–µ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–∞–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å chunks –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
   - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
   - –ò–Ω–¥–µ–∫—Å—ã –≤ –ë–î –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ admin/manager)
   - –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ (–ª–∏–º–∏—Ç—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—Å—ã–ª–æ–∫)

5. **UX:**
   - –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
   - –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–π —Ä–∞—Å—Å—ã–ª–∫–µ
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞—Å—Å—ã–ª–∫–∏
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã —Ä–∞—Å—Å—ã–ª–∫–∏ (–¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π)

---

## üìÖ –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–≠—Ç–∞–ø 1** - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–∏ (1-2 —á–∞—Å–∞)
2. **–≠—Ç–∞–ø 2** - Backend —Å–µ—Ä–≤–∏—Å—ã (2-3 —á–∞—Å–∞)
3. **–≠—Ç–∞–ø 3** - Backend –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (2-3 —á–∞—Å–∞)
4. **–≠—Ç–∞–ø 4** - –ú–∞—Ä—à—Ä—É—Ç—ã –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ webhook (1 —á–∞—Å)
5. **–≠—Ç–∞–ø 6** - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (1-2 —á–∞—Å–∞)
6. **–≠—Ç–∞–ø 5** - Frontend –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (4-6 —á–∞—Å–æ–≤)
7. **–≠—Ç–∞–ø 7** - –í–∞–ª–∏–¥–∞—Ü–∏—è (1 —á–∞—Å)
8. **–≠—Ç–∞–ø 8** - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, 1-2 —á–∞—Å–∞)
9. **–≠—Ç–∞–ø 9** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (2-3 —á–∞—Å–∞)
10. **–≠—Ç–∞–ø 10** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (1-2 —á–∞—Å–∞)

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** 16-25 —á–∞—Å–æ–≤

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-04  
**–í–µ—Ä—Å–∏—è –ø–ª–∞–Ω–∞:** 1.0



