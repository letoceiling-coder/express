import{d as y,b as _}from"./api-DRy2cUet.js";import{s as u}from"./swal-C5DxUZ5S.js";import{_ as b,c as n,o as d,a as e,f as p,g as x,r as h,d as c,v,C as f,t as a,b as g,F as k,q as w,p as C,e as B}from"./admin-DjMp7ShK.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const M={name:"PaymentMethods",data(){return{methods:[],loading:!1,error:null,searchQuery:"",statusFilter:"",sortBy:"sort_order"}},computed:{filteredMethods(){let r=[...this.methods];if(this.searchQuery){const t=this.searchQuery.toLowerCase();r=r.filter(o=>o.name.toLowerCase().includes(t)||o.code.toLowerCase().includes(t)||o.description&&o.description.toLowerCase().includes(t))}if(this.statusFilter!==""){const t=this.statusFilter==="true";r=r.filter(o=>o.is_enabled===t)}return r.sort((t,o)=>this.sortBy==="sort_order"?(t.sort_order||0)-(o.sort_order||0):this.sortBy==="name"?t.name.localeCompare(o.name):this.sortBy==="created_at"?new Date(o.created_at)-new Date(t.created_at):0),r}},mounted(){this.loadMethods()},methods:{async loadMethods(){this.loading=!0,this.error=null;try{const r=await _("/payment-methods");if(!r.ok){const o=await r.json();throw new Error(o.message||"Ошибка загрузки способов оплаты")}const t=await r.json();Array.isArray(t.data)?this.methods=t.data:Array.isArray(t)?this.methods=t:this.methods=[]}catch(r){this.error=r.message||"Ошибка загрузки способов оплаты",console.error("Error loading payment methods:",r)}finally{this.loading=!1}},async handleDelete(r){if((await u.confirm("Вы уверены, что хотите удалить этот способ оплаты?","Удаление способа оплаты","Удалить","Отмена")).isConfirmed)try{await y(`/payment-methods/${r}`),this.methods=this.methods.filter(o=>o.id!==r),await u.success("Способ оплаты успешно удален")}catch(o){await u.error(o.response?.data?.message||"Ошибка удаления способа оплаты")}}}},D={class:"payment-methods-page"},F={class:"mb-6 flex items-center justify-between"},L={class:"bg-card rounded-lg border border-border p-4 mb-6"},V={class:"flex gap-4 items-end flex-wrap"},N={class:"flex-1 min-w-[200px]"},Q={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},U={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},j={class:"text-destructive"},A={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},E={class:"w-full"},S={class:"divide-y divide-border"},q={class:"px-6 py-4"},P={class:"text-sm font-mono text-foreground"},R={class:"px-6 py-4"},T={class:"font-medium text-foreground"},z={class:"px-6 py-4"},G={class:"text-sm text-muted-foreground line-clamp-2"},H={class:"px-6 py-4"},I={key:0,class:"text-sm"},J={class:"text-foreground"},K={key:0,class:"text-xs text-muted-foreground mt-1"},O={key:1,class:"text-sm text-muted-foreground"},W={class:"px-6 py-4"},X={class:"text-sm text-foreground"},Y={class:"px-6 py-4"},Z={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},$={key:1,class:"text-sm text-muted-foreground"},ee={class:"px-6 py-4"},te={class:"px-6 py-4 text-right"},se={class:"flex items-center justify-end gap-2"},re=["onClick"],oe={key:0,class:"p-12 text-center"};function ne(r,t,o,de,l,i){const m=h("router-link");return d(),n("div",D,[e("div",F,[t[4]||(t[4]=e("div",null,[e("h1",{class:"text-2xl font-bold text-foreground"},"Способы оплаты"),e("p",{class:"text-muted-foreground mt-1"},"Управление способами оплаты и настройками скидок")],-1)),p(m,{to:"/payment-methods/create",class:"h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 inline-flex items-center gap-2"},{default:x(()=>[...t[3]||(t[3]=[e("span",null,"+",-1),e("span",null,"Создать способ оплаты",-1)])]),_:1})]),e("div",L,[e("div",V,[e("div",N,[t[5]||(t[5]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Поиск",-1)),c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.searchQuery=s),type:"text",placeholder:"Поиск по названию, коду...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[v,l.searchQuery]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Статус",-1)),c(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.statusFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[6]||(t[6]=[e("option",{value:""},"Все",-1),e("option",{value:"true"},"Активные",-1),e("option",{value:"false"},"Неактивные",-1)])],512),[[f,l.statusFilter]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Сортировка",-1)),c(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.sortBy=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[8]||(t[8]=[e("option",{value:"sort_order"},"По порядку",-1),e("option",{value:"name"},"По названию",-1),e("option",{value:"created_at"},"По дате",-1)])],512),[[f,l.sortBy]])])])]),l.loading?(d(),n("div",Q,[...t[10]||(t[10]=[e("p",{class:"text-muted-foreground"},"Загрузка способов оплаты...",-1)])])):l.error?(d(),n("div",U,[e("p",j,a(l.error),1)])):(d(),n("div",A,[e("table",E,[t[12]||(t[12]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Код"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Название"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Описание"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Скидка"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Порядок"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"По умолчанию"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Статус"),e("th",{class:"px-6 py-3 text-right text-sm font-medium text-foreground"},"Действия")])],-1)),e("tbody",S,[(d(!0),n(k,null,w(i.filteredMethods,s=>(d(),n("tr",{key:s.id},[e("td",q,[e("span",P,a(s.code),1)]),e("td",R,[e("div",T,a(s.name),1)]),e("td",z,[e("div",G,a(s.description||"—"),1)]),e("td",H,[s.discount_type!=="none"?(d(),n("div",I,[e("span",J,a(s.discount_type==="percentage"?`${s.discount_value}%`:`${Number(s.discount_value).toLocaleString("ru-RU")} ₽`),1),s.min_cart_amount?(d(),n("div",K," от "+a(Number(s.min_cart_amount).toLocaleString("ru-RU"))+" ₽ ",1)):g("",!0)])):(d(),n("span",O,"Нет скидки"))]),e("td",W,[e("span",X,a(s.sort_order||0),1)]),e("td",Y,[s.is_default?(d(),n("span",Z," Да ")):(d(),n("span",$,"—"))]),e("td",ee,[e("span",{class:C(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",s.is_enabled?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"])},a(s.is_enabled?"Активен":"Неактивен"),3)]),e("td",te,[e("div",se,[p(m,{to:`/payment-methods/${s.id}/edit`,class:"h-8 px-3 text-sm bg-accent/10 text-accent rounded-lg hover:bg-accent/20"},{default:x(()=>[...t[11]||(t[11]=[B(" Редактировать ",-1)])]),_:1},8,["to"]),e("button",{onClick:le=>i.handleDelete(s.id),class:"h-8 px-3 text-sm bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Удалить ",8,re)])])]))),128))])]),i.filteredMethods.length===0?(d(),n("div",oe,[...t[13]||(t[13]=[e("p",{class:"text-muted-foreground"},"Способы оплаты не найдены",-1)])])):g("",!0)]))])}const me=b(M,[["render",ne]]);export{me as default};
