import{d as g,a as _}from"./api-BrgWxvgT.js";import{_ as y,c as d,o as n,a as e,f as p,g as m,r as b,d as u,v as h,C as x,t as i,b as f,F as v,q as k,p as w,e as C}from"./admin-Dbz-L3Lt.js";const B={name:"PaymentMethods",data(){return{methods:[],loading:!1,error:null,searchQuery:"",statusFilter:"",sortBy:"sort_order"}},computed:{filteredMethods(){let r=[...this.methods];if(this.searchQuery){const t=this.searchQuery.toLowerCase();r=r.filter(o=>o.name.toLowerCase().includes(t)||o.code.toLowerCase().includes(t)||o.description&&o.description.toLowerCase().includes(t))}if(this.statusFilter!==""){const t=this.statusFilter==="true";r=r.filter(o=>o.is_enabled===t)}return r.sort((t,o)=>this.sortBy==="sort_order"?(t.sort_order||0)-(o.sort_order||0):this.sortBy==="name"?t.name.localeCompare(o.name):this.sortBy==="created_at"?new Date(o.created_at)-new Date(t.created_at):0),r}},mounted(){this.loadMethods()},methods:{async loadMethods(){this.loading=!0,this.error=null;try{const r=await _("/payment-methods");this.methods=r.data||[]}catch(r){this.error=r.response?.data?.message||"Ошибка загрузки способов оплаты",console.error("Error loading payment methods:",r)}finally{this.loading=!1}},async handleDelete(r){if(confirm("Вы уверены, что хотите удалить этот способ оплаты?"))try{await g(`/payment-methods/${r}`),this.methods=this.methods.filter(t=>t.id!==r)}catch(t){alert(t.response?.data?.message||"Ошибка удаления способа оплаты")}}}},M={class:"payment-methods-page"},D={class:"mb-6 flex items-center justify-between"},F={class:"bg-card rounded-lg border border-border p-4 mb-6"},L={class:"flex gap-4 items-end flex-wrap"},V={class:"flex-1 min-w-[200px]"},N={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},Q={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},U={class:"text-destructive"},S={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},E={class:"w-full"},j={class:"divide-y divide-border"},q={class:"px-6 py-4"},P={class:"text-sm font-mono text-foreground"},R={class:"px-6 py-4"},T={class:"font-medium text-foreground"},z={class:"px-6 py-4"},G={class:"text-sm text-muted-foreground line-clamp-2"},A={class:"px-6 py-4"},H={key:0,class:"text-sm"},I={class:"text-foreground"},J={key:0,class:"text-xs text-muted-foreground mt-1"},K={key:1,class:"text-sm text-muted-foreground"},O={class:"px-6 py-4"},W={class:"text-sm text-foreground"},X={class:"px-6 py-4"},Y={class:"px-6 py-4 text-right"},Z={class:"flex items-center justify-end gap-2"},$=["onClick"],ee={key:0,class:"p-12 text-center"};function te(r,t,o,se,l,a){const c=b("router-link");return n(),d("div",M,[e("div",D,[t[4]||(t[4]=e("div",null,[e("h1",{class:"text-2xl font-bold text-foreground"},"Способы оплаты"),e("p",{class:"text-muted-foreground mt-1"},"Управление способами оплаты и настройками скидок")],-1)),p(c,{to:"/payment-methods/create",class:"h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 inline-flex items-center gap-2"},{default:m(()=>[...t[3]||(t[3]=[e("span",null,"+",-1),e("span",null,"Создать способ оплаты",-1)])]),_:1})]),e("div",F,[e("div",L,[e("div",V,[t[5]||(t[5]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Поиск",-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.searchQuery=s),type:"text",placeholder:"Поиск по названию, коду...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[h,l.searchQuery]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Статус",-1)),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.statusFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[6]||(t[6]=[e("option",{value:""},"Все",-1),e("option",{value:"true"},"Активные",-1),e("option",{value:"false"},"Неактивные",-1)])],512),[[x,l.statusFilter]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Сортировка",-1)),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.sortBy=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[8]||(t[8]=[e("option",{value:"sort_order"},"По порядку",-1),e("option",{value:"name"},"По названию",-1),e("option",{value:"created_at"},"По дате",-1)])],512),[[x,l.sortBy]])])])]),l.loading?(n(),d("div",N,[...t[10]||(t[10]=[e("p",{class:"text-muted-foreground"},"Загрузка способов оплаты...",-1)])])):l.error?(n(),d("div",Q,[e("p",U,i(l.error),1)])):(n(),d("div",S,[e("table",E,[t[12]||(t[12]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Код"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Название"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Описание"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Скидка"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Порядок"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Статус"),e("th",{class:"px-6 py-3 text-right text-sm font-medium text-foreground"},"Действия")])],-1)),e("tbody",j,[(n(!0),d(v,null,k(a.filteredMethods,s=>(n(),d("tr",{key:s.id},[e("td",q,[e("span",P,i(s.code),1)]),e("td",R,[e("div",T,i(s.name),1)]),e("td",z,[e("div",G,i(s.description||"—"),1)]),e("td",A,[s.discount_type!=="none"?(n(),d("div",H,[e("span",I,i(s.discount_type==="percentage"?`${s.discount_value}%`:`${Number(s.discount_value).toLocaleString("ru-RU")} ₽`),1),s.min_cart_amount?(n(),d("div",J," от "+i(Number(s.min_cart_amount).toLocaleString("ru-RU"))+" ₽ ",1)):f("",!0)])):(n(),d("span",K,"Нет скидки"))]),e("td",O,[e("span",W,i(s.sort_order||0),1)]),e("td",X,[e("span",{class:w(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",s.is_enabled?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"])},i(s.is_enabled?"Активен":"Неактивен"),3)]),e("td",Y,[e("div",Z,[p(c,{to:`/payment-methods/${s.id}/edit`,class:"h-8 px-3 text-sm bg-accent/10 text-accent rounded-lg hover:bg-accent/20"},{default:m(()=>[...t[11]||(t[11]=[C(" Редактировать ",-1)])]),_:1},8,["to"]),e("button",{onClick:re=>a.handleDelete(s.id),class:"h-8 px-3 text-sm bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Удалить ",8,$)])])]))),128))])]),a.filteredMethods.length===0?(n(),d("div",ee,[...t[13]||(t[13]=[e("p",{class:"text-muted-foreground"},"Способы оплаты не найдены",-1)])])):f("",!0)]))])}const ne=y(B,[["render",te]]);export{ne as default};
