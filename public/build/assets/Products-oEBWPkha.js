import{p as m,e as _}from"./api-CW0Hk-Qs.js";import{_ as k,c as o,o as l,a as e,b as c,f as x,g as f,r as w,d as p,v as C,C as h,F as b,q as y,t as a,w as F,p as E,e as v}from"./admin-DoEPDmfO.js";const I={name:"Products",data(){return{products:[],categories:[],loading:!1,error:null,searchQuery:"",categoryFilter:"",statusFilter:"",sortBy:"sort_order",exporting:!1,showImportDialog:!1,selectedFile:null,importing:!1,importError:null,importSuccess:null}},computed:{filteredProducts(){let t=[...Array.isArray(this.products)?this.products:[]];if(this.searchQuery){const n=this.searchQuery.toLowerCase();t=t.filter(d=>d.name.toLowerCase().includes(n)||d.sku&&d.sku.toLowerCase().includes(n)||d.barcode&&d.barcode.toLowerCase().includes(n))}if(this.categoryFilter&&(t=t.filter(n=>n.category_id&&Number(n.category_id)===Number(this.categoryFilter))),this.statusFilter!==""){const n=this.statusFilter==="true";t=t.filter(d=>d.is_available===n)}return t.sort((n,d)=>this.sortBy==="sort_order"?(n.sort_order||0)-(d.sort_order||0):this.sortBy==="name"?n.name.localeCompare(d.name):this.sortBy==="price"?Number(n.price)-Number(d.price):this.sortBy==="created_at"?new Date(d.created_at)-new Date(n.created_at):0),t}},mounted(){this.loadProducts(),this.loadCategories()},methods:{async loadProducts(){this.loading=!0,this.error=null;try{const i=await m.getAll();this.products=Array.isArray(i.data)?i.data:[]}catch(i){this.error=i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",this.products=[]}finally{this.loading=!1}},async loadCategories(){try{const i=await _.getAll();this.categories=i.data||[]}catch(i){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹:",i)}},async handleDelete(i){if(confirm(`Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€ "${i.name}"?`))try{await m.delete(i.id),await this.loadProducts()}catch(t){alert(t.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°")}},async handleExportCsv(){this.exporting=!0;try{await m.exportCsv(),alert("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² CSV Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(i){alert(i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² CSV")}finally{this.exporting=!1}},async handleExportExcel(){this.exporting=!0;try{await m.exportExcel(),alert("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² Excel Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(i){alert(i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² Excel")}finally{this.exporting=!1}},handleFileSelect(i){this.selectedFile=i.target.files[0]||null,this.importError=null,this.importSuccess=null},async handleImport(){if(!this.selectedFile){this.importError="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð°";return}this.importing=!0,this.importError=null,this.importSuccess=null;try{const i=this.$refs.imagesArchiveInput?.files[0]||null,t=await m.import(this.selectedFile,i);this.importSuccess=t.message||"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹",await this.loadProducts(),setTimeout(()=>{this.showImportDialog=!1,this.selectedFile=null,this.$refs.importFileInput&&(this.$refs.importFileInput.value=""),this.$refs.imagesArchiveInput&&(this.$refs.imagesArchiveInput.value=""),this.importSuccess=null},2e3)}catch(i){this.importError=i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²"}finally{this.importing=!1}}}},S={class:"products-page"},A={class:"mb-6 flex items-center justify-between"},D={class:"flex items-center gap-2"},P=["disabled"],V={key:0},B={key:1},N=["disabled"],L={key:0},U={key:1},j={class:"bg-card rounded-lg border border-border p-4 mb-6"},Q={class:"flex gap-4 items-end flex-wrap"},q={class:"flex-1 min-w-[200px]"},z=["value"],M={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},T={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},R={class:"text-destructive"},Z={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},G={class:"w-full"},H={class:"divide-y divide-border"},J={class:"px-6 py-4"},K=["src","alt"],O={key:1,class:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center"},W={class:"px-6 py-4"},X={class:"font-medium text-foreground"},Y={key:0,class:"text-sm text-muted-foreground"},$={class:"px-6 py-4"},ee={key:0,class:"text-sm text-foreground"},te={key:1,class:"text-sm text-muted-foreground"},se={class:"px-6 py-4"},re={class:"text-sm text-foreground"},oe={class:"px-6 py-4"},le={class:"text-sm font-medium text-foreground"},ie={key:0,class:"text-xs text-muted-foreground line-through"},ne={class:"px-6 py-4"},de={class:"text-sm text-foreground"},ae={class:"px-6 py-4"},ue={class:"px-6 py-4 text-right"},ce={class:"flex items-center justify-end gap-2"},me=["onClick"],pe={key:0,class:"p-12 text-center"},ge={class:"bg-card rounded-lg border border-border p-6 max-w-md w-full mx-4"},xe={class:"space-y-4"},fe={ref:"imagesArchiveInput",type:"file",accept:".zip",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},he={key:0,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-3"},be={class:"text-destructive text-sm"},ye={key:1,class:"bg-green-100 border border-green-300 rounded-lg p-3"},ve={class:"text-green-800 text-sm"},_e={class:"flex gap-2 mt-6"},ke=["disabled"],we={key:0},Ce={key:1};function Fe(i,t,n,d,r,u){const g=w("router-link");return l(),o("div",S,[e("div",A,[t[13]||(t[13]=e("div",null,[e("h1",{class:"text-2xl font-bold text-foreground"},"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹"),e("p",{class:"text-muted-foreground mt-1"},"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ð¼Ð¸")],-1)),e("div",D,[e("button",{onClick:t[0]||(t[0]=(...s)=>u.handleExportCsv&&u.handleExportCsv(...s)),class:"h-10 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(l(),o("span",V,"...")):(l(),o("span",B,"ðŸ“¥ CSV"))],8,P),e("button",{onClick:t[1]||(t[1]=(...s)=>u.handleExportExcel&&u.handleExportExcel(...s)),class:"h-10 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(l(),o("span",L,"...")):(l(),o("span",U,"ðŸ“¥ Excel"))],8,N),e("button",{onClick:t[2]||(t[2]=s=>r.showImportDialog=!0),class:"h-10 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 inline-flex items-center gap-2"},[...t[11]||(t[11]=[e("span",null,"ðŸ“¤ Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚",-1)])]),x(g,{to:"/products/create",class:"h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 inline-flex items-center gap-2"},{default:f(()=>[...t[12]||(t[12]=[e("span",null,"+",-1),e("span",null,"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€",-1)])]),_:1})])]),e("div",j,[e("div",Q,[e("div",q,[t[14]||(t[14]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"ÐŸÐ¾Ð¸ÑÐº",-1)),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.searchQuery=s),type:"text",placeholder:"ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ, Ð°Ñ€Ñ‚Ð¸ÐºÑƒÐ»Ñƒ, ÑˆÑ‚Ñ€Ð¸Ñ…-ÐºÐ¾Ð´Ñƒ...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[C,r.searchQuery]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ",-1)),p(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.categoryFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[t[15]||(t[15]=e("option",{value:""},"Ð’ÑÐµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",-1)),(l(!0),o(b,null,y(r.categories,s=>(l(),o("option",{key:s.id,value:s.id},a(s.name),9,z))),128))],512),[[h,r.categoryFilter]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ",-1)),p(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>r.statusFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[17]||(t[17]=[e("option",{value:""},"Ð’ÑÐµ",-1),e("option",{value:"true"},"Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹",-1),e("option",{value:"false"},"ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹",-1)])],512),[[h,r.statusFilter]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°",-1)),p(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>r.sortBy=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[19]||(t[19]=[e("option",{value:"sort_order"},"ÐŸÐ¾ Ð¿Ð¾Ñ€ÑÐ´ÐºÑƒ",-1),e("option",{value:"name"},"ÐŸÐ¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ",-1),e("option",{value:"price"},"ÐŸÐ¾ Ñ†ÐµÐ½Ðµ",-1),e("option",{value:"created_at"},"ÐŸÐ¾ Ð´Ð°Ñ‚Ðµ",-1)])],512),[[h,r.sortBy]])])])]),r.loading?(l(),o("div",M,[...t[21]||(t[21]=[e("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²...",-1)])])):r.error?(l(),o("div",T,[e("p",R,a(r.error),1)])):(l(),o("div",Z,[e("table",G,[t[25]||(t[25]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐÑ€Ñ‚Ð¸ÐºÑƒÐ»"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð¦ÐµÐ½Ð°"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐžÑÑ‚Ð°Ñ‚Ð¾Ðº"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ"),e("th",{class:"px-6 py-3 text-right text-sm font-medium text-foreground"},"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ")])],-1)),e("tbody",H,[(l(!0),o(b,null,y(u.filteredProducts,s=>(l(),o("tr",{key:s.id},[e("td",J,[s.image?.url?(l(),o("img",{key:0,src:s.image.url,alt:s.name,class:"w-16 h-16 object-cover rounded-lg"},null,8,K)):(l(),o("div",O,[...t[22]||(t[22]=[e("span",{class:"text-muted-foreground text-xs"},"ÐÐµÑ‚ Ñ„Ð¾Ñ‚Ð¾",-1)])]))]),e("td",W,[e("div",X,a(s.name),1),s.slug?(l(),o("div",Y,a(s.slug),1)):c("",!0)]),e("td",$,[s.category?(l(),o("span",ee,a(s.category.name),1)):(l(),o("span",te,"â€”"))]),e("td",se,[e("span",re,a(s.sku||"â€”"),1)]),e("td",oe,[e("div",le,a(Number(s.price).toLocaleString("ru-RU"))+" â‚½ ",1),s.compare_price?(l(),o("div",ie,a(Number(s.compare_price).toLocaleString("ru-RU"))+" â‚½ ",1)):c("",!0)]),e("td",ne,[e("span",de,a(s.stock_quantity||0),1)]),e("td",ae,[e("span",{class:E([s.is_available?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 rounded-full text-xs font-medium"])},a(s.is_available?"Ð”Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½":"ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½"),3)]),e("td",ue,[e("div",ce,[x(g,{to:`/products/${s.id}/edit`,class:"h-8 px-3 text-sm bg-accent/10 text-accent rounded-lg hover:bg-accent/20"},{default:f(()=>[...t[23]||(t[23]=[v(" Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ",-1)])]),_:1},8,["to"]),x(g,{to:`/products/${s.id}/history`,class:"h-8 px-3 text-sm bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:f(()=>[...t[24]||(t[24]=[v(" Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ ",-1)])]),_:1},8,["to"]),e("button",{onClick:Ee=>u.handleDelete(s),class:"h-8 px-3 text-sm bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ",8,me)])])]))),128))])]),u.filteredProducts.length===0?(l(),o("div",pe,[...t[26]||(t[26]=[e("p",{class:"text-muted-foreground"},"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹",-1)])])):c("",!0)])),r.showImportDialog?(l(),o("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:t[10]||(t[10]=F(s=>r.showImportDialog=!1,["self"]))},[e("div",ge,[t[29]||(t[29]=e("h2",{class:"text-xl font-bold text-foreground mb-4"},"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",-1)),e("div",xe,[e("div",null,[t[27]||(t[27]=e("label",{class:"text-sm font-medium text-foreground mb-2 block"}," Ð¤Ð°Ð¹Ð» (CSV Ð¸Ð»Ð¸ Excel) ",-1)),e("input",{ref:"importFileInput",type:"file",accept:".csv,.xlsx,.xls",class:"w-full h-10 px-3 rounded-lg border border-input bg-background",onChange:t[7]||(t[7]=(...s)=>u.handleFileSelect&&u.handleFileSelect(...s))},null,544)]),e("div",null,[t[28]||(t[28]=e("label",{class:"text-sm font-medium text-foreground mb-2 block"}," ÐÑ€Ñ…Ð¸Ð² Ñ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸ÑÐ¼Ð¸ (ZIP, Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) ",-1)),e("input",fe,null,512)]),r.importError?(l(),o("div",he,[e("p",be,a(r.importError),1)])):c("",!0),r.importSuccess?(l(),o("div",ye,[e("p",ve,a(r.importSuccess),1)])):c("",!0)]),e("div",_e,[e("button",{onClick:t[8]||(t[8]=s=>r.showImportDialog=!1),class:"flex-1 h-10 px-4 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),e("button",{onClick:t[9]||(t[9]=(...s)=>u.handleImport&&u.handleImport(...s)),class:"flex-1 h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",disabled:r.importing||!r.selectedFile},[r.importing?(l(),o("span",we,"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚...")):(l(),o("span",Ce,"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"))],8,ke)])])])):c("",!0)])}const Ae=k(I,[["render",Fe]]);export{Ae as default};
