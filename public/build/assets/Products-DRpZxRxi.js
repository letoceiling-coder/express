import{p,e as k}from"./api-B1vwYlcP.js";import{s as c}from"./swal-C5DxUZ5S.js";import{_ as w,c as o,o as l,a as t,b as m,f,g as h,r as C,d as g,v as I,C as b,F as y,q as v,t as u,w as F,p as E,e as _}from"./admin-Clk-iSTQ.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const S={name:"Products",data(){return{products:[],categories:[],loading:!1,error:null,searchQuery:"",categoryFilter:"",statusFilter:"",sortBy:"sort_order",exporting:!1,showImportDialog:!1,selectedFile:null,importing:!1,importError:null,importSuccess:null}},computed:{filteredProducts(){let e=[...Array.isArray(this.products)?this.products:[]];if(this.searchQuery){const n=this.searchQuery.toLowerCase();e=e.filter(a=>a.name.toLowerCase().includes(n)||a.sku&&a.sku.toLowerCase().includes(n)||a.barcode&&a.barcode.toLowerCase().includes(n))}if(this.categoryFilter&&(e=e.filter(n=>n.category_id&&Number(n.category_id)===Number(this.categoryFilter))),this.statusFilter!==""){const n=this.statusFilter==="true";e=e.filter(a=>a.is_available===n)}return e.sort((n,a)=>this.sortBy==="sort_order"?(n.sort_order||0)-(a.sort_order||0):this.sortBy==="name"?n.name.localeCompare(a.name):this.sortBy==="price"?Number(n.price)-Number(a.price):this.sortBy==="created_at"?new Date(a.created_at)-new Date(n.created_at):0),e}},mounted(){this.loadProducts(),this.loadCategories()},methods:{async loadProducts(){this.loading=!0,this.error=null;try{const i=await p.getAll();this.products=Array.isArray(i.data)?i.data:[]}catch(i){this.error=i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",this.products=[]}finally{this.loading=!1}},async loadCategories(){try{const i=await k.getAll();this.categories=i.data||[]}catch(i){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹:",i)}},async handleDelete(i){if((await c.confirm(`Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€ "${i.name}"?`,"Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°","Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ","ÐžÑ‚Ð¼ÐµÐ½Ð°")).isConfirmed)try{await p.delete(i.id),await this.loadProducts(),await c.success("Ð¢Ð¾Ð²Ð°Ñ€ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑƒÐ´Ð°Ð»ÐµÐ½")}catch(n){await c.error(n.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°")}},async handleExportCsv(){this.exporting=!0;try{await p.exportCsv(),await c.success("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² CSV Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(i){await c.error(i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² CSV")}finally{this.exporting=!1}},async handleExportExcel(){this.exporting=!0;try{await p.exportExcel(),await c.success("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² Excel Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(i){await c.error(i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² Excel")}finally{this.exporting=!1}},async handleExportZip(){this.exporting=!0;try{await p.exportZip(),await c.success("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² ZIP Ñ Ñ„Ð¾Ñ‚Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(i){await c.error(i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² ZIP")}finally{this.exporting=!1}},openImportDialog(){this.selectedFile=null,this.importError=null,this.importSuccess=null,this.showImportDialog=!0,this.$nextTick(()=>{this.$refs.importFileInput&&(this.$refs.importFileInput.value=""),this.$refs.imagesArchiveInput&&(this.$refs.imagesArchiveInput.value="")})},handleFileSelect(i){const e=i.target.files?.[0]||null;this.selectedFile=e,this.importError=null,this.importSuccess=null,e?console.log("Ð¤Ð°Ð¹Ð» Ð²Ñ‹Ð±Ñ€Ð°Ð½:",e.name,e.size):console.log("Ð¤Ð°Ð¹Ð» Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½")},async handleImport(){if(!this.selectedFile){this.importError="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð°";return}this.importing=!0,this.importError=null,this.importSuccess=null;try{const i=this.$refs.imagesArchiveInput?.files[0]||null,e=await p.import(this.selectedFile,i);this.importSuccess=e.message||"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹",await this.loadProducts(),setTimeout(()=>{this.showImportDialog=!1,this.selectedFile=null,this.$refs.importFileInput&&(this.$refs.importFileInput.value=""),this.$refs.imagesArchiveInput&&(this.$refs.imagesArchiveInput.value=""),this.importSuccess=null},2e3)}catch(i){this.importError=i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²"}finally{this.importing=!1}}}},A={class:"products-page"},D={class:"mb-6 flex items-center justify-between"},P={class:"flex items-center gap-2"},V=["disabled"],B={key:0},N={key:1},Z=["disabled"],L={key:0},U={key:1},j=["disabled"],Q={key:0},z={key:1},T={class:"bg-card rounded-lg border border-border p-4 mb-6"},q={class:"flex gap-4 items-end flex-wrap"},M={class:"flex-1 min-w-[200px]"},R=["value"],G={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},H={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},J={class:"text-destructive"},K={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},O={class:"w-full"},W={class:"divide-y divide-border"},X={class:"px-6 py-4"},Y=["src","alt"],$={key:1,class:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center"},ee={class:"px-6 py-4"},te={class:"font-medium text-foreground"},se={key:0,class:"text-sm text-muted-foreground"},re={class:"px-6 py-4"},oe={key:0,class:"text-sm text-foreground"},le={key:1,class:"text-sm text-muted-foreground"},ie={class:"px-6 py-4"},ne={class:"text-sm text-foreground"},de={class:"px-6 py-4"},ae={class:"text-sm font-medium text-foreground"},ue={key:0,class:"text-xs text-muted-foreground line-through"},ce={class:"px-6 py-4"},pe={class:"text-sm text-foreground"},me={class:"px-6 py-4"},ge={class:"px-6 py-4 text-right"},xe={class:"flex items-center justify-end gap-2"},fe=["onClick"],he={key:0,class:"p-12 text-center"},be={class:"bg-card rounded-lg border border-border p-6 max-w-md w-full mx-4"},ye={class:"space-y-4"},ve={ref:"imagesArchiveInput",type:"file",accept:".zip",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},_e={key:0,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-3"},ke={class:"text-destructive text-sm"},we={key:1,class:"bg-green-100 border border-green-300 rounded-lg p-3"},Ce={class:"text-green-800 text-sm"},Ie={class:"flex gap-2 mt-6"},Fe=["disabled"],Ee={key:0},Se={key:1};function Ae(i,e,n,a,r,d){const x=C("router-link");return l(),o("div",A,[t("div",D,[e[14]||(e[14]=t("div",null,[t("h1",{class:"text-2xl font-bold text-foreground"},"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹"),t("p",{class:"text-muted-foreground mt-1"},"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ð¼Ð¸")],-1)),t("div",P,[t("button",{onClick:e[0]||(e[0]=(...s)=>d.handleExportCsv&&d.handleExportCsv(...s)),class:"h-10 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(l(),o("span",B,"...")):(l(),o("span",N,"ðŸ“¥ CSV"))],8,V),t("button",{onClick:e[1]||(e[1]=(...s)=>d.handleExportExcel&&d.handleExportExcel(...s)),class:"h-10 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(l(),o("span",L,"...")):(l(),o("span",U,"ðŸ“¥ Excel"))],8,Z),t("button",{onClick:e[2]||(e[2]=(...s)=>d.handleExportZip&&d.handleExportZip(...s)),class:"h-10 px-4 bg-orange-600 text-white rounded-lg hover:bg-orange-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(l(),o("span",Q,"...")):(l(),o("span",z,"ðŸ“¦ ZIP + Ñ„Ð¾Ñ‚Ð¾"))],8,j),t("button",{onClick:e[3]||(e[3]=(...s)=>d.openImportDialog&&d.openImportDialog(...s)),class:"h-10 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 inline-flex items-center gap-2"},[...e[12]||(e[12]=[t("span",null,"ðŸ“¤ Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚",-1)])]),f(x,{to:"/products/create",class:"h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 inline-flex items-center gap-2"},{default:h(()=>[...e[13]||(e[13]=[t("span",null,"+",-1),t("span",null,"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€",-1)])]),_:1})])]),t("div",T,[t("div",q,[t("div",M,[e[15]||(e[15]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"ÐŸÐ¾Ð¸ÑÐº",-1)),g(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>r.searchQuery=s),type:"text",placeholder:"ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ, Ð°Ñ€Ñ‚Ð¸ÐºÑƒÐ»Ñƒ, ÑˆÑ‚Ñ€Ð¸Ñ…-ÐºÐ¾Ð´Ñƒ...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[I,r.searchQuery]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ",-1)),g(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>r.categoryFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[e[16]||(e[16]=t("option",{value:""},"Ð’ÑÐµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",-1)),(l(!0),o(y,null,v(r.categories,s=>(l(),o("option",{key:s.id,value:s.id},u(s.name),9,R))),128))],512),[[b,r.categoryFilter]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ",-1)),g(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>r.statusFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...e[18]||(e[18]=[t("option",{value:""},"Ð’ÑÐµ",-1),t("option",{value:"true"},"Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹",-1),t("option",{value:"false"},"ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹",-1)])],512),[[b,r.statusFilter]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°",-1)),g(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>r.sortBy=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...e[20]||(e[20]=[t("option",{value:"sort_order"},"ÐŸÐ¾ Ð¿Ð¾Ñ€ÑÐ´ÐºÑƒ",-1),t("option",{value:"name"},"ÐŸÐ¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ",-1),t("option",{value:"price"},"ÐŸÐ¾ Ñ†ÐµÐ½Ðµ",-1),t("option",{value:"created_at"},"ÐŸÐ¾ Ð´Ð°Ñ‚Ðµ",-1)])],512),[[b,r.sortBy]])])])]),r.loading?(l(),o("div",G,[...e[22]||(e[22]=[t("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²...",-1)])])):r.error?(l(),o("div",H,[t("p",J,u(r.error),1)])):(l(),o("div",K,[t("table",O,[e[26]||(e[26]=t("thead",{class:"bg-muted/50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐÑ€Ñ‚Ð¸ÐºÑƒÐ»"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð¦ÐµÐ½Ð°"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐžÑÑ‚Ð°Ñ‚Ð¾Ðº"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ"),t("th",{class:"px-6 py-3 text-right text-sm font-medium text-foreground"},"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ")])],-1)),t("tbody",W,[(l(!0),o(y,null,v(d.filteredProducts,s=>(l(),o("tr",{key:s.id},[t("td",X,[s.image?.url?(l(),o("img",{key:0,src:s.image.url,alt:s.name,class:"w-16 h-16 object-cover rounded-lg"},null,8,Y)):(l(),o("div",$,[...e[23]||(e[23]=[t("span",{class:"text-muted-foreground text-xs"},"ÐÐµÑ‚ Ñ„Ð¾Ñ‚Ð¾",-1)])]))]),t("td",ee,[t("div",te,u(s.name),1),s.slug?(l(),o("div",se,u(s.slug),1)):m("",!0)]),t("td",re,[s.category?(l(),o("span",oe,u(s.category.name),1)):(l(),o("span",le,"â€”"))]),t("td",ie,[t("span",ne,u(s.sku||"â€”"),1)]),t("td",de,[t("div",ae,u(Number(s.price).toLocaleString("ru-RU"))+" â‚½ ",1),s.compare_price?(l(),o("div",ue,u(Number(s.compare_price).toLocaleString("ru-RU"))+" â‚½ ",1)):m("",!0)]),t("td",ce,[t("span",pe,u(s.stock_quantity||0),1)]),t("td",me,[t("span",{class:E([s.is_available?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 rounded-full text-xs font-medium"])},u(s.is_available?"Ð”Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½":"ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½"),3)]),t("td",ge,[t("div",xe,[f(x,{to:`/products/${s.id}/edit`,class:"h-8 px-3 text-sm bg-accent/10 text-accent rounded-lg hover:bg-accent/20"},{default:h(()=>[...e[24]||(e[24]=[_(" Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ",-1)])]),_:1},8,["to"]),f(x,{to:`/products/${s.id}/history`,class:"h-8 px-3 text-sm bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:h(()=>[...e[25]||(e[25]=[_(" Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ ",-1)])]),_:1},8,["to"]),t("button",{onClick:De=>d.handleDelete(s),class:"h-8 px-3 text-sm bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ",8,fe)])])]))),128))])]),d.filteredProducts.length===0?(l(),o("div",he,[...e[27]||(e[27]=[t("p",{class:"text-muted-foreground"},"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹",-1)])])):m("",!0)])),r.showImportDialog?(l(),o("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[11]||(e[11]=F(s=>r.showImportDialog=!1,["self"]))},[t("div",be,[e[30]||(e[30]=t("h2",{class:"text-xl font-bold text-foreground mb-4"},"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",-1)),t("div",ye,[t("div",null,[e[28]||(e[28]=t("label",{class:"text-sm font-medium text-foreground mb-2 block"}," Ð¤Ð°Ð¹Ð» (CSV Ð¸Ð»Ð¸ Excel) ",-1)),t("input",{ref:"importFileInput",type:"file",accept:".csv,.xlsx,.xls",class:"w-full h-10 px-3 rounded-lg border border-input bg-background",onChange:e[8]||(e[8]=(...s)=>d.handleFileSelect&&d.handleFileSelect(...s))},null,544)]),t("div",null,[e[29]||(e[29]=t("label",{class:"text-sm font-medium text-foreground mb-2 block"}," ÐÑ€Ñ…Ð¸Ð² Ñ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸ÑÐ¼Ð¸ (ZIP, Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) ",-1)),t("input",ve,null,512)]),r.importError?(l(),o("div",_e,[t("p",ke,u(r.importError),1)])):m("",!0),r.importSuccess?(l(),o("div",we,[t("p",Ce,u(r.importSuccess),1)])):m("",!0)]),t("div",Ie,[t("button",{onClick:e[9]||(e[9]=s=>r.showImportDialog=!1),class:"flex-1 h-10 px-4 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),t("button",{onClick:e[10]||(e[10]=(...s)=>d.handleImport&&d.handleImport(...s)),class:"flex-1 h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",disabled:r.importing||!r.selectedFile},[r.importing?(l(),o("span",Ee,"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚...")):(l(),o("span",Se,"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"))],8,Fe)])])])):m("",!0)])}const Ze=w(S,[["render",Ae]]);export{Ze as default};
