import{p as h,e as V}from"./api-ZcUKU0Jq.js";import{M as C}from"./MediaSelector-CwduAVeT.js";import{s as G}from"./swal-C5DxUZ5S.js";import{_ as I,c as d,o as n,a as t,f as b,w as U,d as s,b as m,e as f,v as i,p as x,t as p,C as _,F as v,q as y,D as k,g as M,r as w}from"./admin-CoRuhh3-.js";import"./Media-PtOJwEl3.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const q={name:"ProductCreate",components:{MediaSelector:C},data(){return{categories:[],form:{name:"",description:"",short_description:"",category_id:null,price:0,compare_price:null,sku:"",barcode:"",stock_quantity:0,is_available:!0,is_weight_product:!1,weight:null,image_id:null,gallery_ids:[],video_id:null,meta_title:"",meta_description:"",sort_order:0},errors:{},loading:!1,showImageSelector:!1,showGallerySelector:!1,showVideoSelector:!1,selectedImage:null,selectedGallery:[],selectedVideo:null}},mounted(){this.loadCategories()},methods:{async loadCategories(){try{const l=await V.getAll();this.categories=l.data||[]}catch(l){console.error("Ошибка загрузки категорий:",l)}},async handleSubmit(){this.errors={},this.loading=!0;try{const l={...this.form,gallery_ids:this.selectedGallery.map(e=>e.id)};await h.create(l),this.$router.push("/products")}catch(l){const e=l.response?.data||{};e.errors?this.errors=e.errors:await G.error(l.message||"Ошибка создания товара")}finally{this.loading=!1}},handleImageSelected(l){this.selectedImage=l,this.form.image_id=l.id,this.showImageSelector=!1},handleGallerySelected(l){(Array.isArray(l)?l:[l]).forEach(g=>{this.selectedGallery.find(a=>a.id===g.id)||this.selectedGallery.push(g)}),this.showGallerySelector=!1},removeFromGallery(l){this.selectedGallery=this.selectedGallery.filter(e=>e.id!==l)},handleVideoSelected(l){this.selectedVideo=l,this.form.video_id=l.id,this.showVideoSelector=!1}}},T={class:"product-create-page"},j={class:"bg-card rounded-lg border border-border p-6"},A={class:"space-y-4"},D={key:0,class:"mt-1 text-sm text-destructive"},P=["value"],F={class:"space-y-4"},N={class:"grid grid-cols-2 gap-4"},B={key:0,class:"mt-1 text-sm text-destructive"},E={class:"space-y-4"},z={class:"grid grid-cols-2 gap-4"},K={class:"grid grid-cols-2 gap-4"},L={class:"flex items-end"},O={class:"flex items-center gap-2 cursor-pointer"},H={class:"space-y-4"},J={class:"grid grid-cols-2 gap-4"},Q={class:"flex items-end"},R={class:"flex items-center gap-2 cursor-pointer"},W={key:0},X={class:"space-y-4"},Y={class:"flex items-center gap-4"},Z=["src"],$={key:1,class:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center"},ee={class:"flex gap-2 flex-wrap mb-2"},te=["src","alt"],oe=["onClick"],re={class:"flex items-center gap-4"},le=["src"],se={key:1,class:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center"},de={class:"space-y-4"},ne={class:"space-y-4"},ie={class:"flex items-center gap-4 pt-4 border-t border-border"},ue=["disabled"];function me(l,e,g,a,o,u){const S=w("router-link"),c=w("MediaSelector");return n(),d("div",T,[e[53]||(e[53]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-foreground"},"Создать товар"),t("p",{class:"text-muted-foreground mt-1"},"Добавление нового товара")],-1)),t("div",j,[t("form",{onSubmit:e[20]||(e[20]=U((...r)=>u.handleSubmit&&u.handleSubmit(...r),["prevent"])),class:"space-y-8"},[t("div",A,[e[29]||(e[29]=t("h2",{class:"text-lg font-semibold text-foreground border-b border-border pb-2"},"Основная информация",-1)),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},[f(" Название "),t("span",{class:"text-destructive"},"*")],-1)),s(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.form.name=r),type:"text",required:"",minlength:"2",class:x(["w-full h-10 px-3 rounded-lg border border-input bg-background",{"border-destructive":o.errors.name}])},null,2),[[i,o.form.name]]),o.errors.name?(n(),d("p",D,p(o.errors.name),1)):m("",!0)]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Краткое описание",-1)),s(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o.form.short_description=r),type:"text",maxlength:"255",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.short_description]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Описание",-1)),s(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=r=>o.form.description=r),rows:"4",class:"w-full px-3 py-2 rounded-lg border border-input bg-background"},null,512),[[i,o.form.description]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Категория",-1)),s(t("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>o.form.category_id=r),class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},[e[27]||(e[27]=t("option",{value:null},"Без категории",-1)),(n(!0),d(v,null,y(o.categories,r=>(n(),d("option",{key:r.id,value:r.id},p(r.name),9,P))),128))],512),[[_,o.form.category_id]])])]),t("div",F,[e[32]||(e[32]=t("h2",{class:"text-lg font-semibold text-foreground border-b border-border pb-2"},"Цены",-1)),t("div",N,[t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},[f(" Цена "),t("span",{class:"text-destructive"},"*")],-1)),s(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>o.form.price=r),type:"number",step:"0.01",min:"0",required:"",class:x(["w-full h-10 px-3 rounded-lg border border-input bg-background",{"border-destructive":o.errors.price}])},null,2),[[i,o.form.price,void 0,{number:!0}]]),o.errors.price?(n(),d("p",B,p(o.errors.price),1)):m("",!0)]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Цена для сравнения",-1)),s(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>o.form.compare_price=r),type:"number",step:"0.01",min:"0",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.compare_price,void 0,{number:!0}]])])])]),t("div",E,[e[37]||(e[37]=t("h2",{class:"text-lg font-semibold text-foreground border-b border-border pb-2"},"Склад",-1)),t("div",z,[t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Артикул (SKU)",-1)),s(t("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>o.form.sku=r),type:"text",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.sku]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Штрих-код",-1)),s(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>o.form.barcode=r),type:"text",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.barcode]])])]),t("div",K,[t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Количество на складе",-1)),s(t("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>o.form.stock_quantity=r),type:"number",min:"0",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.stock_quantity,void 0,{number:!0}]])]),t("div",L,[t("label",O,[s(t("input",{"onUpdate:modelValue":e[9]||(e[9]=r=>o.form.is_available=r),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[k,o.form.is_available]]),e[36]||(e[36]=t("span",{class:"text-sm font-medium text-foreground"},"Товар доступен",-1))])])])]),t("div",H,[e[40]||(e[40]=t("h2",{class:"text-lg font-semibold text-foreground border-b border-border pb-2"},"Характеристики",-1)),t("div",J,[t("div",Q,[t("label",R,[s(t("input",{"onUpdate:modelValue":e[10]||(e[10]=r=>o.form.is_weight_product=r),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[k,o.form.is_weight_product]]),e[38]||(e[38]=t("span",{class:"text-sm font-medium text-foreground"},"Товар на вес",-1))])]),o.form.is_weight_product?(n(),d("div",W,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Вес (кг)",-1)),s(t("input",{"onUpdate:modelValue":e[11]||(e[11]=r=>o.form.weight=r),type:"number",step:"0.01",min:"0",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.weight,void 0,{number:!0}]])])):m("",!0)])]),t("div",X,[e[46]||(e[46]=t("h2",{class:"text-lg font-semibold text-foreground border-b border-border pb-2"},"Медиа",-1)),t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Главное изображение",-1)),t("div",Y,[o.selectedImage?(n(),d("img",{key:0,src:o.selectedImage.url,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-border"},null,8,Z)):(n(),d("div",$,[...e[41]||(e[41]=[t("span",{class:"text-muted-foreground text-sm"},"Нет изображения",-1)])])),t("div",null,[t("button",{type:"button",onClick:e[12]||(e[12]=r=>o.showImageSelector=!0),class:"h-10 px-4 bg-accent/10 text-accent rounded-lg hover:bg-accent/20"}," Выбрать из медиа "),o.selectedImage?(n(),d("button",{key:0,type:"button",onClick:e[13]||(e[13]=r=>{o.selectedImage=null,o.form.image_id=null}),class:"ml-2 h-10 px-4 bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Удалить ")):m("",!0)])])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Галерея изображений",-1)),t("div",ee,[(n(!0),d(v,null,y(o.selectedGallery,r=>(n(),d("div",{key:r.id,class:"relative group"},[t("img",{src:r.url,alt:r.name,class:"w-24 h-24 object-cover rounded-lg border border-border"},null,8,te),t("button",{type:"button",onClick:be=>u.removeFromGallery(r.id),class:"absolute -top-1 -right-1 w-5 h-5 bg-destructive text-white rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity"}," ✕ ",8,oe)]))),128))]),t("button",{type:"button",onClick:e[14]||(e[14]=r=>o.showGallerySelector=!0),class:"h-10 px-4 bg-accent/10 text-accent rounded-lg hover:bg-accent/20"}," + Добавить изображения ")]),t("div",null,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Видео",-1)),t("div",re,[o.selectedVideo?(n(),d("video",{key:0,src:o.selectedVideo.url,class:"w-32 h-32 object-cover rounded-lg border border-border",controls:""},null,8,le)):(n(),d("div",se,[...e[44]||(e[44]=[t("span",{class:"text-muted-foreground text-sm"},"Нет видео",-1)])])),t("div",null,[t("button",{type:"button",onClick:e[15]||(e[15]=r=>o.showVideoSelector=!0),class:"h-10 px-4 bg-accent/10 text-accent rounded-lg hover:bg-accent/20"}," Выбрать видео "),o.selectedVideo?(n(),d("button",{key:0,type:"button",onClick:e[16]||(e[16]=r=>{o.selectedVideo=null,o.form.video_id=null}),class:"ml-2 h-10 px-4 bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Удалить ")):m("",!0)])])])]),t("div",de,[e[49]||(e[49]=t("h2",{class:"text-lg font-semibold text-foreground border-b border-border pb-2"},"SEO",-1)),t("div",null,[e[47]||(e[47]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Meta Title",-1)),s(t("input",{"onUpdate:modelValue":e[17]||(e[17]=r=>o.form.meta_title=r),type:"text",maxlength:"255",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.meta_title]])]),t("div",null,[e[48]||(e[48]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Meta Description",-1)),s(t("textarea",{"onUpdate:modelValue":e[18]||(e[18]=r=>o.form.meta_description=r),rows:"3",class:"w-full px-3 py-2 rounded-lg border border-input bg-background"},null,512),[[i,o.form.meta_description]])])]),t("div",ne,[e[51]||(e[51]=t("h2",{class:"text-lg font-semibold text-foreground border-b border-border pb-2"},"Прочее",-1)),t("div",null,[e[50]||(e[50]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Порядок сортировки",-1)),s(t("input",{"onUpdate:modelValue":e[19]||(e[19]=r=>o.form.sort_order=r),type:"number",min:"0",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.sort_order,void 0,{number:!0}]])])]),t("div",ie,[t("button",{type:"submit",disabled:o.loading,class:"h-10 px-6 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"},p(o.loading?"Создание...":"Создать товар"),9,ue),b(S,{to:"/products",class:"h-10 px-6 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:M(()=>[...e[52]||(e[52]=[f(" Отмена ",-1)])]),_:1})])],32)]),b(c,{open:o.showImageSelector,multiple:!1,allowedTypes:["photo"],currentSelection:o.selectedImage?[o.selectedImage]:[],onClose:e[21]||(e[21]=r=>o.showImageSelector=!1),onSelect:u.handleImageSelected},null,8,["open","currentSelection","onSelect"]),b(c,{open:o.showGallerySelector,multiple:!0,allowedTypes:["photo"],currentSelection:o.selectedGallery,onClose:e[22]||(e[22]=r=>o.showGallerySelector=!1),onSelect:u.handleGallerySelected},null,8,["open","currentSelection","onSelect"]),b(c,{open:o.showVideoSelector,multiple:!1,allowedTypes:["video"],currentSelection:o.selectedVideo?[o.selectedVideo]:[],onClose:e[23]||(e[23]=r=>o.showVideoSelector=!1),onSelect:u.handleVideoSelected},null,8,["open","currentSelection","onSelect"])])}const ve=I(q,[["render",me]]);export{ve as default};
