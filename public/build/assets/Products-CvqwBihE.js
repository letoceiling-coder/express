import{p,e as k}from"./api-B7D-dDks.js";import{s as c}from"./swal-C5DxUZ5S.js";import{_ as w,c as o,o as l,a as e,b as m,f,g as h,r as C,d as g,v as F,C as b,F as y,q as v,t as a,w as E,p as I,e as _}from"./admin-BMK_kT9-.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const S={name:"Products",data(){return{products:[],categories:[],loading:!1,error:null,searchQuery:"",categoryFilter:"",statusFilter:"",sortBy:"sort_order",exporting:!1,showImportDialog:!1,selectedFile:null,importing:!1,importError:null,importSuccess:null}},computed:{filteredProducts(){let t=[...Array.isArray(this.products)?this.products:[]];if(this.searchQuery){const n=this.searchQuery.toLowerCase();t=t.filter(d=>d.name.toLowerCase().includes(n)||d.sku&&d.sku.toLowerCase().includes(n)||d.barcode&&d.barcode.toLowerCase().includes(n))}if(this.categoryFilter&&(t=t.filter(n=>n.category_id&&Number(n.category_id)===Number(this.categoryFilter))),this.statusFilter!==""){const n=this.statusFilter==="true";t=t.filter(d=>d.is_available===n)}return t.sort((n,d)=>this.sortBy==="sort_order"?(n.sort_order||0)-(d.sort_order||0):this.sortBy==="name"?n.name.localeCompare(d.name):this.sortBy==="price"?Number(n.price)-Number(d.price):this.sortBy==="created_at"?new Date(d.created_at)-new Date(n.created_at):0),t}},mounted(){this.loadProducts(),this.loadCategories()},methods:{async loadProducts(){this.loading=!0,this.error=null;try{const i=await p.getAll();this.products=Array.isArray(i.data)?i.data:[]}catch(i){this.error=i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",this.products=[]}finally{this.loading=!1}},async loadCategories(){try{const i=await k.getAll();this.categories=i.data||[]}catch(i){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹:",i)}},async handleDelete(i){if((await c.confirm(`Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€ "${i.name}"?`,"Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°","Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ","ÐžÑ‚Ð¼ÐµÐ½Ð°")).isConfirmed)try{await p.delete(i.id),await this.loadProducts(),await c.success("Ð¢Ð¾Ð²Ð°Ñ€ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑƒÐ´Ð°Ð»ÐµÐ½")}catch(n){await c.error(n.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°")}},async handleExportCsv(){this.exporting=!0;try{await p.exportCsv(),await c.success("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² CSV Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(i){await c.error(i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² CSV")}finally{this.exporting=!1}},async handleExportExcel(){this.exporting=!0;try{await p.exportExcel(),await c.success("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² Excel Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(i){await c.error(i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² Excel")}finally{this.exporting=!1}},handleFileSelect(i){this.selectedFile=i.target.files[0]||null,this.importError=null,this.importSuccess=null},async handleImport(){if(!this.selectedFile){this.importError="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð°";return}this.importing=!0,this.importError=null,this.importSuccess=null;try{const i=this.$refs.imagesArchiveInput?.files[0]||null,t=await p.import(this.selectedFile,i);this.importSuccess=t.message||"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹",await this.loadProducts(),setTimeout(()=>{this.showImportDialog=!1,this.selectedFile=null,this.$refs.importFileInput&&(this.$refs.importFileInput.value=""),this.$refs.imagesArchiveInput&&(this.$refs.imagesArchiveInput.value=""),this.importSuccess=null},2e3)}catch(i){this.importError=i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²"}finally{this.importing=!1}}}},A={class:"products-page"},D={class:"mb-6 flex items-center justify-between"},P={class:"flex items-center gap-2"},V=["disabled"],B={key:0},N={key:1},L=["disabled"],U={key:0},j={key:1},Q={class:"bg-card rounded-lg border border-border p-4 mb-6"},q={class:"flex gap-4 items-end flex-wrap"},z={class:"flex-1 min-w-[200px]"},M=["value"],T={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},R={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},Z={class:"text-destructive"},G={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},H={class:"w-full"},J={class:"divide-y divide-border"},K={class:"px-6 py-4"},O=["src","alt"],W={key:1,class:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center"},X={class:"px-6 py-4"},Y={class:"font-medium text-foreground"},$={key:0,class:"text-sm text-muted-foreground"},ee={class:"px-6 py-4"},te={key:0,class:"text-sm text-foreground"},se={key:1,class:"text-sm text-muted-foreground"},re={class:"px-6 py-4"},oe={class:"text-sm text-foreground"},le={class:"px-6 py-4"},ie={class:"text-sm font-medium text-foreground"},ne={key:0,class:"text-xs text-muted-foreground line-through"},de={class:"px-6 py-4"},ae={class:"text-sm text-foreground"},ue={class:"px-6 py-4"},ce={class:"px-6 py-4 text-right"},me={class:"flex items-center justify-end gap-2"},pe=["onClick"],ge={key:0,class:"p-12 text-center"},xe={class:"bg-card rounded-lg border border-border p-6 max-w-md w-full mx-4"},fe={class:"space-y-4"},he={ref:"imagesArchiveInput",type:"file",accept:".zip",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},be={key:0,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-3"},ye={class:"text-destructive text-sm"},ve={key:1,class:"bg-green-100 border border-green-300 rounded-lg p-3"},_e={class:"text-green-800 text-sm"},ke={class:"flex gap-2 mt-6"},we=["disabled"],Ce={key:0},Fe={key:1};function Ee(i,t,n,d,r,u){const x=C("router-link");return l(),o("div",A,[e("div",D,[t[13]||(t[13]=e("div",null,[e("h1",{class:"text-2xl font-bold text-foreground"},"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹"),e("p",{class:"text-muted-foreground mt-1"},"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ð¼Ð¸")],-1)),e("div",P,[e("button",{onClick:t[0]||(t[0]=(...s)=>u.handleExportCsv&&u.handleExportCsv(...s)),class:"h-10 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(l(),o("span",B,"...")):(l(),o("span",N,"ðŸ“¥ CSV"))],8,V),e("button",{onClick:t[1]||(t[1]=(...s)=>u.handleExportExcel&&u.handleExportExcel(...s)),class:"h-10 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(l(),o("span",U,"...")):(l(),o("span",j,"ðŸ“¥ Excel"))],8,L),e("button",{onClick:t[2]||(t[2]=s=>r.showImportDialog=!0),class:"h-10 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 inline-flex items-center gap-2"},[...t[11]||(t[11]=[e("span",null,"ðŸ“¤ Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚",-1)])]),f(x,{to:"/products/create",class:"h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 inline-flex items-center gap-2"},{default:h(()=>[...t[12]||(t[12]=[e("span",null,"+",-1),e("span",null,"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€",-1)])]),_:1})])]),e("div",Q,[e("div",q,[e("div",z,[t[14]||(t[14]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"ÐŸÐ¾Ð¸ÑÐº",-1)),g(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.searchQuery=s),type:"text",placeholder:"ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ, Ð°Ñ€Ñ‚Ð¸ÐºÑƒÐ»Ñƒ, ÑˆÑ‚Ñ€Ð¸Ñ…-ÐºÐ¾Ð´Ñƒ...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[F,r.searchQuery]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ",-1)),g(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.categoryFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[t[15]||(t[15]=e("option",{value:""},"Ð’ÑÐµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",-1)),(l(!0),o(y,null,v(r.categories,s=>(l(),o("option",{key:s.id,value:s.id},a(s.name),9,M))),128))],512),[[b,r.categoryFilter]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ",-1)),g(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>r.statusFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[17]||(t[17]=[e("option",{value:""},"Ð’ÑÐµ",-1),e("option",{value:"true"},"Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹",-1),e("option",{value:"false"},"ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹",-1)])],512),[[b,r.statusFilter]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°",-1)),g(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>r.sortBy=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[19]||(t[19]=[e("option",{value:"sort_order"},"ÐŸÐ¾ Ð¿Ð¾Ñ€ÑÐ´ÐºÑƒ",-1),e("option",{value:"name"},"ÐŸÐ¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ",-1),e("option",{value:"price"},"ÐŸÐ¾ Ñ†ÐµÐ½Ðµ",-1),e("option",{value:"created_at"},"ÐŸÐ¾ Ð´Ð°Ñ‚Ðµ",-1)])],512),[[b,r.sortBy]])])])]),r.loading?(l(),o("div",T,[...t[21]||(t[21]=[e("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²...",-1)])])):r.error?(l(),o("div",R,[e("p",Z,a(r.error),1)])):(l(),o("div",G,[e("table",H,[t[25]||(t[25]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐÑ€Ñ‚Ð¸ÐºÑƒÐ»"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð¦ÐµÐ½Ð°"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐžÑÑ‚Ð°Ñ‚Ð¾Ðº"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ"),e("th",{class:"px-6 py-3 text-right text-sm font-medium text-foreground"},"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ")])],-1)),e("tbody",J,[(l(!0),o(y,null,v(u.filteredProducts,s=>(l(),o("tr",{key:s.id},[e("td",K,[s.image?.url?(l(),o("img",{key:0,src:s.image.url,alt:s.name,class:"w-16 h-16 object-cover rounded-lg"},null,8,O)):(l(),o("div",W,[...t[22]||(t[22]=[e("span",{class:"text-muted-foreground text-xs"},"ÐÐµÑ‚ Ñ„Ð¾Ñ‚Ð¾",-1)])]))]),e("td",X,[e("div",Y,a(s.name),1),s.slug?(l(),o("div",$,a(s.slug),1)):m("",!0)]),e("td",ee,[s.category?(l(),o("span",te,a(s.category.name),1)):(l(),o("span",se,"â€”"))]),e("td",re,[e("span",oe,a(s.sku||"â€”"),1)]),e("td",le,[e("div",ie,a(Number(s.price).toLocaleString("ru-RU"))+" â‚½ ",1),s.compare_price?(l(),o("div",ne,a(Number(s.compare_price).toLocaleString("ru-RU"))+" â‚½ ",1)):m("",!0)]),e("td",de,[e("span",ae,a(s.stock_quantity||0),1)]),e("td",ue,[e("span",{class:I([s.is_available?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 rounded-full text-xs font-medium"])},a(s.is_available?"Ð”Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½":"ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½"),3)]),e("td",ce,[e("div",me,[f(x,{to:`/products/${s.id}/edit`,class:"h-8 px-3 text-sm bg-accent/10 text-accent rounded-lg hover:bg-accent/20"},{default:h(()=>[...t[23]||(t[23]=[_(" Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ",-1)])]),_:1},8,["to"]),f(x,{to:`/products/${s.id}/history`,class:"h-8 px-3 text-sm bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:h(()=>[...t[24]||(t[24]=[_(" Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ ",-1)])]),_:1},8,["to"]),e("button",{onClick:Ie=>u.handleDelete(s),class:"h-8 px-3 text-sm bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ",8,pe)])])]))),128))])]),u.filteredProducts.length===0?(l(),o("div",ge,[...t[26]||(t[26]=[e("p",{class:"text-muted-foreground"},"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹",-1)])])):m("",!0)])),r.showImportDialog?(l(),o("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:t[10]||(t[10]=E(s=>r.showImportDialog=!1,["self"]))},[e("div",xe,[t[29]||(t[29]=e("h2",{class:"text-xl font-bold text-foreground mb-4"},"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",-1)),e("div",fe,[e("div",null,[t[27]||(t[27]=e("label",{class:"text-sm font-medium text-foreground mb-2 block"}," Ð¤Ð°Ð¹Ð» (CSV Ð¸Ð»Ð¸ Excel) ",-1)),e("input",{ref:"importFileInput",type:"file",accept:".csv,.xlsx,.xls",class:"w-full h-10 px-3 rounded-lg border border-input bg-background",onChange:t[7]||(t[7]=(...s)=>u.handleFileSelect&&u.handleFileSelect(...s))},null,544)]),e("div",null,[t[28]||(t[28]=e("label",{class:"text-sm font-medium text-foreground mb-2 block"}," ÐÑ€Ñ…Ð¸Ð² Ñ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸ÑÐ¼Ð¸ (ZIP, Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) ",-1)),e("input",he,null,512)]),r.importError?(l(),o("div",be,[e("p",ye,a(r.importError),1)])):m("",!0),r.importSuccess?(l(),o("div",ve,[e("p",_e,a(r.importSuccess),1)])):m("",!0)]),e("div",ke,[e("button",{onClick:t[8]||(t[8]=s=>r.showImportDialog=!1),class:"flex-1 h-10 px-4 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),e("button",{onClick:t[9]||(t[9]=(...s)=>u.handleImport&&u.handleImport(...s)),class:"flex-1 h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",disabled:r.importing||!r.selectedFile},[r.importing?(l(),o("span",Ce,"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚...")):(l(),o("span",Fe,"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"))],8,we)])])])):m("",!0)])}const Ve=w(S,[["render",Ee]]);export{Ve as default};
