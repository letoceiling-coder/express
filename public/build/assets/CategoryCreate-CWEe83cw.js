import{c as f,e as p}from"./api-CmjUIRnx.js";import{_ as c,c as l,a as t,b as a,w as x,d as n,e as m,v as u,p as v,t as b,N as y,f as h,g as w,h as k,o as d}from"./admin-Xl7ZIXaL.js";const I={name:"CategoryCreate",data(){return{form:{name:"",description:"",image_id:null,sort_order:0,is_active:!0},errors:{},loading:!1,showMediaSelector:!1,selectedImage:null,mediaIdInput:""}},methods:{async handleSubmit(){this.errors={},this.loading=!0;try{if(!this.form.name||this.form.name.length<2){this.errors.name="Название должно содержать минимум 2 символа",this.loading=!1;return}await p.create(this.form),this.$router.push("/categories")}catch(s){const e=s.response?.data||{};e.errors?this.errors=e.errors:alert(s.message||"Ошибка создания категории")}finally{this.loading=!1}},async handleSelectMediaById(){if(!this.mediaIdInput){alert("Введите ID изображения");return}try{const s=await f(`/media/${this.mediaIdInput}`);if(!s.ok)throw new Error("Изображение не найдено");const e=await s.json();this.selectedImage=e.data,this.form.image_id=e.data.id,this.showMediaSelector=!1,this.mediaIdInput=""}catch(s){alert(s.message||"Ошибка загрузки изображения")}}}},C={class:"category-create-page"},S={class:"bg-card rounded-lg border border-border p-6"},M={key:0,class:"mt-1 text-sm text-destructive"},V={class:"flex items-center gap-4"},D=["src"],j={key:1,class:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center"},B={class:"flex items-center gap-2 cursor-pointer"},N={class:"flex items-center gap-4 pt-4 border-t border-border"},U=["disabled"],_={key:0,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center"},z={class:"bg-card rounded-lg border border-border p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto"},E={class:"flex items-center justify-between mb-4"},P={class:"space-y-4"};function T(s,e,q,A,r,i){const g=k("router-link");return d(),l("div",C,[e[22]||(e[22]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-foreground"},"Создать категорию"),t("p",{class:"text-muted-foreground mt-1"},"Добавление новой категории товаров")],-1)),t("div",S,[t("form",{onSubmit:e[6]||(e[6]=x((...o)=>i.handleSubmit&&i.handleSubmit(...o),["prevent"])),class:"space-y-6"},[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},[m(" Название "),t("span",{class:"text-destructive"},"*")],-1)),n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.form.name=o),type:"text",required:"",minlength:"2",class:v(["w-full h-10 px-3 rounded-lg border border-input bg-background",{"border-destructive":r.errors.name}])},null,2),[[u,r.form.name]]),r.errors.name?(d(),l("p",M,b(r.errors.name),1)):a("",!0)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Описание",-1)),n(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.form.description=o),rows:"4",class:"w-full px-3 py-2 rounded-lg border border-input bg-background"},null,512),[[u,r.form.description]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Изображение",-1)),t("div",V,[r.selectedImage?(d(),l("img",{key:0,src:r.selectedImage.url,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-border"},null,8,D)):(d(),l("div",j,[...e[12]||(e[12]=[t("span",{class:"text-muted-foreground text-sm"},"Нет изображения",-1)])])),t("div",null,[t("button",{type:"button",onClick:e[2]||(e[2]=o=>r.showMediaSelector=!0),class:"h-10 px-4 bg-accent/10 text-accent rounded-lg hover:bg-accent/20"}," Выбрать из медиа "),r.selectedImage?(d(),l("button",{key:0,type:"button",onClick:e[3]||(e[3]=o=>{r.selectedImage=null,r.form.image_id=null}),class:"ml-2 h-10 px-4 bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Удалить ")):a("",!0)])]),e[14]||(e[14]=t("p",{class:"mt-2 text-sm text-muted-foreground"},"Выберите изображение из медиа-библиотеки",-1))]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Порядок сортировки",-1)),n(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.form.sort_order=o),type:"number",min:"0",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[u,r.form.sort_order,void 0,{number:!0}]])]),t("div",null,[t("label",B,[n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.form.is_active=o),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[y,r.form.is_active]]),e[16]||(e[16]=t("span",{class:"text-sm font-medium text-foreground"},"Категория активна",-1))])]),t("div",N,[t("button",{type:"submit",disabled:r.loading,class:"h-10 px-6 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"},b(r.loading?"Создание...":"Создать категорию"),9,U),h(g,{to:"/categories",class:"h-10 px-6 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:w(()=>[...e[17]||(e[17]=[m(" Отмена ",-1)])]),_:1})])],32)]),r.showMediaSelector?(d(),l("div",_,[t("div",z,[t("div",E,[e[18]||(e[18]=t("h2",{class:"text-xl font-bold text-foreground"},"Выбор изображения",-1)),t("button",{onClick:e[7]||(e[7]=o=>r.showMediaSelector=!1),class:"h-8 w-8 flex items-center justify-center rounded-lg hover:bg-muted"}," ✕ ")]),e[21]||(e[21]=t("p",{class:"text-sm text-muted-foreground mb-4"}," Откройте медиа-библиотеку в отдельной вкладке и скопируйте ID выбранного изображения: ",-1)),t("div",P,[e[20]||(e[20]=t("a",{href:"/admin/media",target:"_blank",class:"block h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 text-center"}," Открыть медиа-библиотеку ",-1)),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"ID изображения",-1)),n(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>r.mediaIdInput=o),type:"number",placeholder:"Введите ID изображения",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[u,r.mediaIdInput]])]),t("button",{onClick:e[9]||(e[9]=(...o)=>i.handleSelectMediaById&&i.handleSelectMediaById(...o)),class:"w-full h-10 px-4 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90"}," Выбрать ")])])])):a("",!0)])}const H=c(I,[["render",T]]);export{H as default};
