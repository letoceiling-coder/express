import{_,c as n,o as i,a as t,f as U,b as p,w as S,d as c,C as g,F as h,q as x,A as M,v as m,t as a,D as T,p as y,r as C,j as v,e as w}from"./admin-DkcX56Aq.js";import{M as V}from"./MediaSelector-DsxdHfUk.js";import"./Media-xYy9rElT.js";import"./api-eBfr8Ons.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const R={name:"Broadcasts",components:{MediaSelector:V},data(){return{bots:[],users:[],availableUsers:[],selectedUsers:[],loading:!1,usersLoading:!1,sending:!1,previewing:!1,recipientType:"all",showUserSelector:!1,userSearchQuery:"",userSearchTimeout:null,previewResult:null,sendResult:null,showMediaSelector:!1,mediaSelectorType:"photo",selectedPhoto:null,selectedVideo:null,selectedMedia:[],form:{bot_id:"",type:"message",telegram_user_ids:null,content:{text:"",photo:"",video:"",document:"",caption:"",media:[]},options:{parse_mode:"HTML",disable_notification:!1}}}},computed:{canPreview(){return this.form.bot_id&&this.form.type&&this.hasContent()},canSend(){return this.canPreview&&(this.recipientType==="all"||this.selectedUsers.length>0)}},mounted(){this.loadBots()},methods:{async loadBots(){try{const r=await v.get("/api/v1/bots");this.bots=r.data.data||[]}catch(r){console.error("Error loading bots:",r)}},async loadUsers(){if(this.form.bot_id){this.usersLoading=!0;try{const r={bot_id:this.form.bot_id,per_page:100,is_blocked:!1};this.userSearchQuery&&(r.search=this.userSearchQuery);const e=await v.get("/api/v1/telegram-users",{params:r});this.availableUsers=e.data.data?.data||[]}catch(r){console.error("Error loading users:",r)}finally{this.usersLoading=!1}}},debounceUserSearch(){clearTimeout(this.userSearchTimeout),this.userSearchTimeout=setTimeout(()=>{this.loadUsers()},500)},handleBotChange(){this.recipientType==="selected"&&(this.selectedUsers=[],this.loadUsers())},handleTypeChange(){this.form.content={text:"",photo:"",video:"",document:"",caption:"",media:[]},this.selectedPhoto=null,this.selectedVideo=null,this.selectedMedia=[]},handleMediaSelect(r){const e=Array.isArray(r)?r:[r],d=u=>u?u.startsWith("BQACAgIAA")||u.match(/^[A-Za-z0-9_-]+$/)||u.startsWith("http://")||u.startsWith("https://")?u:u.startsWith("/")?window.location.origin+u:u:"";if(this.mediaSelectorType==="photo"){if(this.selectedPhoto=e[0]||null,this.selectedPhoto){const u=this.selectedPhoto.telegram_file_id||this.selectedPhoto.url||"";this.form.content.photo=d(u)}}else if(this.mediaSelectorType==="video"){if(this.selectedVideo=e[0]||null,this.selectedVideo){const u=this.selectedVideo.telegram_file_id||this.selectedVideo.url||"";this.form.content.video=d(u)}}else this.mediaSelectorType==="media_group"&&(this.selectedMedia=e.map(u=>({...u,caption:u.caption||""})),this.updateMediaGroup());this.showMediaSelector=!1},removePhoto(){this.selectedPhoto=null,this.form.content.photo=""},removeVideo(){this.selectedVideo=null,this.form.content.video=""},removeMedia(r){this.selectedMedia.splice(r,1),this.updateMediaGroup()},updateMediaCaption(r,e){this.selectedMedia[r]&&(this.selectedMedia[r].caption=e,this.updateMediaGroup())},updateMediaGroup(){const r=e=>e?e.startsWith("BQACAgIAA")||e.match(/^[A-Za-z0-9_-]+$/)||e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?window.location.origin+e:e:"";this.form.content.media=this.selectedMedia.map((e,d)=>{const u=e.telegram_file_id||e.url||"";return{type:e.type==="photo"?"photo":"video",media:r(u),caption:e.caption||void 0}})},handleRecipientTypeChange(){this.recipientType==="all"?(this.form.telegram_user_ids=null,this.selectedUsers=[]):(this.form.telegram_user_ids=[],this.form.bot_id&&this.loadUsers())},toggleUserSelection(r){const e=this.selectedUsers.findIndex(d=>d.id===r.id);e>=0?this.selectedUsers.splice(e,1):this.selectedUsers.push(r),this.updateFormUserIds()},removeUser(r){this.selectedUsers=this.selectedUsers.filter(e=>e.id!==r),this.updateFormUserIds()},isUserSelected(r){return this.selectedUsers.some(e=>e.id===r)},updateFormUserIds(){this.form.telegram_user_ids=this.selectedUsers.map(r=>r.telegram_id)},hasContent(){return this.form.type==="message"?!!this.form.content.text:this.form.type==="photo"?!!this.form.content.photo:this.form.type==="video"?!!this.form.content.video:this.form.type==="document"?!!this.form.content.document:this.form.type==="media_group"?this.selectedMedia.length>0&&this.selectedMedia.length<=10:!1},getTypeLabel(r){return{message:"–°–æ–æ–±—â–µ–Ω–∏–µ",photo:"–§–æ—Ç–æ + —Ç–µ–∫—Å—Ç",video:"–í–∏–¥–µ–æ + —Ç–µ–∫—Å—Ç",document:"–î–æ–∫—É–º–µ–Ω—Ç",media_group:"–ì–∞–ª–µ—Ä–µ—è"}[r]||r},async previewBroadcast(){if(!this.form.bot_id){alert("–í—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞");return}this.previewing=!0,this.previewResult=null,this.sendResult=null;try{const r=this.buildContent(),e={bot_id:this.form.bot_id,type:this.form.type,content:r,telegram_user_ids:this.recipientType==="all"?null:this.form.telegram_user_ids},d=await v.post("/api/v1/broadcasts/preview",e);this.previewResult=d.data.data}catch(r){alert(r.response?.data?.message||"–û—à–∏–±–∫–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞"),console.error("Error previewing broadcast:",r)}finally{this.previewing=!1}},async sendBroadcast(){if(confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É?")){this.sending=!0,this.sendResult=null;try{const r=this.buildContent(),e={bot_id:this.form.bot_id,type:this.form.type,content:r,options:this.form.options,telegram_user_ids:this.recipientType==="all"?null:this.form.telegram_user_ids},d=await v.post("/api/v1/broadcasts/send",e);d.data.success?(this.sendResult={success:!0,data:d.data.data},setTimeout(()=>{this.resetForm()},5e3)):this.sendResult={success:!1,message:d.data.message||"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–∞—Å—Å—ã–ª–∫–∏"}}catch(r){this.sendResult={success:!1,message:r.response?.data?.message||"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–∞—Å—Å—ã–ª–∫–∏"},console.error("Error sending broadcast:",r)}finally{this.sending=!1}}},buildContent(){const r=d=>d?d.startsWith("BQACAgIAA")||d.match(/^[A-Za-z0-9_-]+$/)||d.startsWith("http://")||d.startsWith("https://")?d:d.startsWith("/")?window.location.origin+d:d:"",e={};return this.form.type==="message"?e.text=this.form.content.text||"":this.form.type==="photo"?(e.photo=r(this.form.content.photo||""),this.form.content.caption&&(e.caption=this.form.content.caption)):this.form.type==="video"?(e.video=r(this.form.content.video||""),this.form.content.caption&&(e.caption=this.form.content.caption)):this.form.type==="document"?(e.document=r(this.form.content.document||""),this.form.content.caption&&(e.caption=this.form.content.caption)):this.form.type==="media_group"&&(e.media=this.form.content.media||[]),e},resetForm(){this.form={bot_id:"",type:"message",telegram_user_ids:null,content:{text:"",photo:"",video:"",document:"",caption:"",media:[]},options:{parse_mode:"HTML",disable_notification:!1}},this.recipientType="all",this.selectedUsers=[],this.selectedMedia=[],this.selectedPhoto=null,this.selectedVideo=null,this.previewResult=null,this.sendResult=null}},watch:{showUserSelector(r){r&&this.form.bot_id&&this.loadUsers()}}},A={class:"broadcasts-page space-y-6"},B={class:"bg-card rounded-lg border border-border p-6"},L=["value"],P={key:0},j={key:1},I={class:"flex gap-2"},W={key:0,class:"mt-2"},z={class:"relative inline-block"},Q=["src","alt"],F={key:2},H={class:"flex gap-2"},q={key:0,class:"mt-2"},D={class:"relative inline-block"},E={key:3},N={key:4},G={key:0,class:"grid grid-cols-4 gap-2 mt-2"},Z=["src","alt"],J={key:1,class:"w-full h-24 bg-muted rounded border border-border flex items-center justify-center"},K=["onClick"],O=["onUpdate:modelValue","onInput"],X={class:"text-xs text-muted-foreground mt-1"},Y={key:0,class:"mt-4"},$={key:0,class:"mt-2 flex flex-wrap gap-2"},ee=["onClick"],te={class:"bg-muted/30 rounded-lg p-4"},oe={class:"space-y-3"},se={class:"flex items-center gap-2"},re={class:"flex gap-2 pt-4 border-t border-border"},ne=["disabled"],ie=["disabled"],le={key:0,class:"mt-6 p-4 bg-muted/50 rounded-lg border border-border"},de={class:"space-y-2"},ue={class:"flex justify-between"},ae={class:"text-sm font-medium text-foreground"},pe={class:"flex justify-between"},ce={class:"text-sm font-medium text-foreground"},me={key:0,class:"space-y-2"},be={class:"flex justify-between"},fe={class:"text-sm font-medium text-foreground"},ge={class:"flex justify-between"},he={class:"text-sm font-medium text-green-500"},xe={class:"flex justify-between"},ve={class:"text-sm font-medium text-red-500"},ye={key:1,class:"text-sm text-red-500"},we={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"},ke={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col"},_e={class:"sticky top-0 bg-background border-b border-border p-4"},Ue={class:"flex items-center justify-between"},Se={class:"mt-3"},Me={class:"flex-1 overflow-y-auto p-4"},Te={key:0,class:"text-center py-8"},Ce={key:1,class:"text-center py-8"},Ve={key:2,class:"space-y-2"},Re=["value","checked","onChange"],Ae={class:"flex-1"},Be={class:"font-medium text-foreground"},Le={key:0,class:"text-muted-foreground"},Pe={class:"text-sm text-muted-foreground font-mono"},je={class:"sticky bottom-0 bg-background border-t border-border p-4"},Ie={class:"flex items-center justify-between"},We={class:"text-sm text-muted-foreground"};function ze(r,e,d,u,o,l){const k=C("MediaSelector");return i(),n("div",A,[e[63]||(e[63]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},"–†–∞—Å—Å—ã–ª–∫–∏"),t("p",{class:"text-muted-foreground mt-1"},"–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ—Ç–∞")])],-1)),t("div",B,[e[59]||(e[59]=t("h2",{class:"text-xl font-semibold text-foreground mb-4"},"–°–æ–∑–¥–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É",-1)),t("form",{onSubmit:e[22]||(e[22]=S((...s)=>l.sendBroadcast&&l.sendBroadcast(...s),["prevent"])),class:"space-y-4"},[t("div",null,[e[29]||(e[29]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"–ë–æ—Ç *",-1)),c(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.bot_id=s),required:"",class:"w-full h-10 px-3 rounded-lg border border-input bg-background",onChange:e[1]||(e[1]=(...s)=>l.handleBotChange&&l.handleBotChange(...s))},[e[28]||(e[28]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞",-1)),(i(!0),n(h,null,x(o.bots,s=>(i(),n("option",{key:s.id,value:s.id},a(s.name),9,L))),128))],544),[[g,o.form.bot_id]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"–¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ *",-1)),c(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.type=s),required:"",class:"w-full h-10 px-3 rounded-lg border border-input bg-background",onChange:e[3]||(e[3]=(...s)=>l.handleTypeChange&&l.handleTypeChange(...s))},[...e[30]||(e[30]=[M('<option value="message">–°–æ–æ–±—â–µ–Ω–∏–µ (—Ç–µ–∫—Å—Ç)</option><option value="photo">–§–æ—Ç–æ + —Ç–µ–∫—Å—Ç</option><option value="video">–í–∏–¥–µ–æ + —Ç–µ–∫—Å—Ç</option><option value="document">–î–æ–∫—É–º–µ–Ω—Ç</option><option value="media_group">–ì–∞–ª–µ—Ä–µ—è (—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)</option>',5)])],544),[[g,o.form.type]])]),o.form.type==="message"?(i(),n("div",P,[e[32]||(e[32]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è *",-1)),c(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.content.text=s),required:"",rows:"6",placeholder:"–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è...",class:"w-full px-3 py-2 rounded-lg border border-input bg-background resize-none font-mono text-sm"},null,512),[[m,o.form.content.text]]),e[33]||(e[33]=t("p",{class:"text-xs text-muted-foreground mt-1"}," –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω parse_mode: HTML ",-1))])):p("",!0),o.form.type==="photo"?(i(),n("div",j,[e[34]||(e[34]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"–§–æ—Ç–æ *",-1)),t("div",I,[t("button",{type:"button",onClick:e[5]||(e[5]=s=>{o.showMediaSelector=!0,o.mediaSelectorType="photo"}),class:"px-4 py-2 border border-border bg-background/50 hover:bg-accent/10 rounded-lg transition-colors"}," –í—ã–±—Ä–∞—Ç—å –∏–∑ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ "),c(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.form.content.photo=s),type:"text",placeholder:"–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ URL/file_id",class:"flex-1 h-10 px-3 rounded-lg border border-input bg-background font-mono text-sm"},null,512),[[m,o.form.content.photo]])]),o.selectedPhoto?(i(),n("div",W,[t("div",z,[t("img",{src:o.selectedPhoto.url,alt:o.selectedPhoto.name,class:"w-32 h-32 object-cover rounded border border-border"},null,8,Q),t("button",{type:"button",onClick:e[7]||(e[7]=(...s)=>l.removePhoto&&l.removePhoto(...s)),class:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs"}," √ó ")])])):p("",!0),e[35]||(e[35]=t("p",{class:"text-xs text-muted-foreground mt-1"}," –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ –∏–∑ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ URL/file_id ",-1)),e[36]||(e[36]=t("label",{class:"text-sm font-medium text-foreground mb-1 block mt-3"},"–ü–æ–¥–ø–∏—Å—å –∫ —Ñ–æ—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",-1)),c(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.form.content.caption=s),rows:"3",placeholder:"–ü–æ–¥–ø–∏—Å—å –∫ —Ñ–æ—Ç–æ...",class:"w-full px-3 py-2 rounded-lg border border-input bg-background resize-none"},null,512),[[m,o.form.content.caption]])])):p("",!0),o.form.type==="video"?(i(),n("div",F,[e[38]||(e[38]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"–í–∏–¥–µ–æ *",-1)),t("div",H,[t("button",{type:"button",onClick:e[9]||(e[9]=s=>{o.showMediaSelector=!0,o.mediaSelectorType="video"}),class:"px-4 py-2 border border-border bg-background/50 hover:bg-accent/10 rounded-lg transition-colors"}," –í—ã–±—Ä–∞—Ç—å –∏–∑ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ "),c(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.form.content.video=s),type:"text",placeholder:"–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ URL/file_id",class:"flex-1 h-10 px-3 rounded-lg border border-input bg-background font-mono text-sm"},null,512),[[m,o.form.content.video]])]),o.selectedVideo?(i(),n("div",q,[t("div",D,[e[37]||(e[37]=t("div",{class:"w-32 h-32 bg-muted rounded border border-border flex items-center justify-center"},[t("span",{class:"text-2xl"},"üé•")],-1)),t("button",{type:"button",onClick:e[11]||(e[11]=(...s)=>l.removeVideo&&l.removeVideo(...s)),class:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs"}," √ó ")])])):p("",!0),e[39]||(e[39]=t("p",{class:"text-xs text-muted-foreground mt-1"}," –í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥–µ–æ –∏–∑ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ URL/file_id ",-1)),e[40]||(e[40]=t("label",{class:"text-sm font-medium text-foreground mb-1 block mt-3"},"–ü–æ–¥–ø–∏—Å—å –∫ –≤–∏–¥–µ–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",-1)),c(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>o.form.content.caption=s),rows:"3",placeholder:"–ü–æ–¥–ø–∏—Å—å –∫ –≤–∏–¥–µ–æ...",class:"w-full px-3 py-2 rounded-lg border border-input bg-background resize-none"},null,512),[[m,o.form.content.caption]])])):p("",!0),o.form.type==="document"?(i(),n("div",E,[e[41]||(e[41]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"URL –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–ª–∏ file_id *",-1)),c(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>o.form.content.document=s),type:"text",required:"",placeholder:"https://example.com/document.pdf –∏–ª–∏ BQACAgIAAxkBAAI...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background font-mono text-sm"},null,512),[[m,o.form.content.document]]),e[42]||(e[42]=t("p",{class:"text-xs text-muted-foreground mt-1"}," –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å URL –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–ª–∏ file_id –∏–∑ Telegram ",-1)),e[43]||(e[43]=t("label",{class:"text-sm font-medium text-foreground mb-1 block mt-3"},"–ü–æ–¥–ø–∏—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",-1)),c(t("textarea",{"onUpdate:modelValue":e[14]||(e[14]=s=>o.form.content.caption=s),rows:"3",placeholder:"–ü–æ–¥–ø–∏—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É...",class:"w-full px-3 py-2 rounded-lg border border-input bg-background resize-none"},null,512),[[m,o.form.content.caption]])])):p("",!0),o.form.type==="media_group"?(i(),n("div",N,[e[45]||(e[45]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"–ú–µ–¥–∏–∞-—Ñ–∞–π–ª—ã *",-1)),t("button",{type:"button",onClick:e[15]||(e[15]=s=>{o.showMediaSelector=!0,o.mediaSelectorType="media_group"}),class:"w-full px-4 py-2 border border-border bg-background/50 hover:bg-accent/10 rounded-lg transition-colors mb-2"},a(o.selectedMedia.length>0?`–í—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${o.selectedMedia.length}`:"–í—ã–±—Ä–∞—Ç—å –º–µ–¥–∏–∞-—Ñ–∞–π–ª—ã"),1),e[46]||(e[46]=t("p",{class:"text-xs text-muted-foreground mb-2"}," –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –¥–æ 10 —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ (–≤ –æ–¥–Ω–æ–π –≥–∞–ª–µ—Ä–µ–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–æ—Ç–æ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –≤–∏–¥–µ–æ) ",-1)),o.selectedMedia.length>0?(i(),n("div",G,[(i(!0),n(h,null,x(o.selectedMedia,(s,b)=>(i(),n("div",{key:s.id||b,class:"relative group"},[s.type==="photo"?(i(),n("img",{key:0,src:s.url,alt:s.name,class:"w-full h-24 object-cover rounded border border-border"},null,8,Z)):(i(),n("div",J,[...e[44]||(e[44]=[t("span",{class:"text-xl"},"üé•",-1)])])),t("button",{type:"button",onClick:f=>l.removeMedia(b),class:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity"}," √ó ",8,K),c(t("input",{"onUpdate:modelValue":f=>s.caption=f,type:"text",placeholder:"–ü–æ–¥–ø–∏—Å—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)",class:"w-full mt-1 px-2 py-1 text-xs rounded border border-border bg-background",onInput:f=>l.updateMediaCaption(b,f.target.value)},null,40,O),[[m,s.caption]])]))),128))])):p("",!0)])):p("",!0),t("div",null,[e[48]||(e[48]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"–ü–æ–ª—É—á–∞—Ç–µ–ª–∏ *",-1)),c(t("select",{"onUpdate:modelValue":e[16]||(e[16]=s=>o.recipientType=s),class:"w-full h-10 px-3 rounded-lg border border-input bg-background mb-2",onChange:e[17]||(e[17]=(...s)=>l.handleRecipientTypeChange&&l.handleRecipientTypeChange(...s))},[...e[47]||(e[47]=[t("option",{value:"all"},"–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞",-1),t("option",{value:"selected"},"–í—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",-1)])],544),[[g,o.recipientType]]),t("p",X,a(o.recipientType==="all"?"–†–∞—Å—Å—ã–ª–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤—Å–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±–æ—Ç–∞":"–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Å–ø–∏—Å–∫–∞"),1),o.recipientType==="selected"?(i(),n("div",Y,[t("button",{type:"button",onClick:e[18]||(e[18]=s=>o.showUserSelector=!0),class:"w-full px-4 py-2 border border-border bg-background/50 hover:bg-accent/10 rounded-lg transition-colors"},a(o.selectedUsers.length>0?`–í—ã–±—Ä–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${o.selectedUsers.length}`:"–í—ã–±—Ä–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"),1),o.selectedUsers.length>0?(i(),n("div",$,[(i(!0),n(h,null,x(o.selectedUsers,s=>(i(),n("span",{key:s.id,class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-500/10 text-blue-500 rounded text-sm"},[w(a(s.first_name||s.username||`ID: ${s.telegram_id}`)+" ",1),t("button",{type:"button",onClick:b=>l.removeUser(s.id),class:"hover:text-blue-700"}," √ó ",8,ee)]))),128))])):p("",!0)])):p("",!0)]),t("div",te,[e[52]||(e[52]=t("label",{class:"text-sm font-medium text-foreground mb-3 block"},"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏",-1)),t("div",oe,[t("div",null,[e[50]||(e[50]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"–§–æ—Ä–º–∞—Ç —Ç–µ–∫—Å—Ç–∞ (parse_mode)",-1)),c(t("select",{"onUpdate:modelValue":e[19]||(e[19]=s=>o.form.options.parse_mode=s),class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},[...e[49]||(e[49]=[t("option",{value:"HTML"},"HTML",-1),t("option",{value:"MarkdownV2"},"MarkdownV2",-1),t("option",{value:null},"–ë–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è",-1)])],512),[[g,o.form.options.parse_mode]])]),t("label",se,[c(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>o.form.options.disable_notification=s),type:"checkbox",class:"w-4 h-4"},null,512),[[T,o.form.options.disable_notification]]),e[51]||(e[51]=t("span",{class:"text-sm"},"–û—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Ç–∏—Ö–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞)",-1))])])]),t("div",re,[t("button",{type:"button",onClick:e[21]||(e[21]=(...s)=>l.previewBroadcast&&l.previewBroadcast(...s)),disabled:o.sending||o.previewing||!l.canPreview,class:"flex-1 px-4 py-2 border border-border bg-background/50 hover:bg-accent/10 rounded-lg transition-colors disabled:opacity-50"},a(o.previewing?"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä...":"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä"),9,ne),t("button",{type:"submit",disabled:o.sending||o.previewing||!l.canSend,class:"flex-1 px-4 py-2 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg transition-colors disabled:opacity-50"},a(o.sending?"–û—Ç–ø—Ä–∞–≤–∫–∞...":"–û—Ç–ø—Ä–∞–≤–∏—Ç—å"),9,ie)])],32),o.previewResult?(i(),n("div",le,[e[55]||(e[55]=t("h3",{class:"text-lg font-semibold text-foreground mb-3"},"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å—Å—ã–ª–∫–∏",-1)),t("div",de,[t("div",ue,[e[53]||(e[53]=t("span",{class:"text-sm text-muted-foreground"},"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π:",-1)),t("span",ae,a(o.previewResult.recipients_count),1)]),t("div",pe,[e[54]||(e[54]=t("span",{class:"text-sm text-muted-foreground"},"–¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞:",-1)),t("span",ce,a(l.getTypeLabel(o.form.type)),1)])])])):p("",!0),o.sendResult?(i(),n("div",{key:1,class:y(["mt-6 p-4 rounded-lg border",o.sendResult.success?"bg-green-500/10 border-green-500/20":"bg-red-500/10 border-red-500/20"])},[t("h3",{class:y(["text-lg font-semibold mb-3",o.sendResult.success?"text-green-500":"text-red-500"])},a(o.sendResult.success?"–†–∞—Å—Å—ã–ª–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞":"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏"),3),o.sendResult.success&&o.sendResult.data?(i(),n("div",me,[t("div",be,[e[56]||(e[56]=t("span",{class:"text-sm text-muted-foreground"},"–í—Å–µ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π:",-1)),t("span",fe,a(o.sendResult.data.total),1)]),t("div",ge,[e[57]||(e[57]=t("span",{class:"text-sm text-muted-foreground"},"–£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ:",-1)),t("span",he,a(o.sendResult.data.sent),1)]),t("div",xe,[e[58]||(e[58]=t("span",{class:"text-sm text-muted-foreground"},"–û—à–∏–±–æ–∫:",-1)),t("span",ve,a(o.sendResult.data.failed),1)])])):(i(),n("p",ye,a(o.sendResult.message),1))],2)):p("",!0)]),U(k,{open:o.showMediaSelector,multiple:o.mediaSelectorType==="media_group",allowedTypes:o.mediaSelectorType==="photo"?["photo"]:o.mediaSelectorType==="video"?["video"]:["photo","video"],currentSelection:o.mediaSelectorType==="photo"?o.selectedPhoto?[o.selectedPhoto]:[]:o.mediaSelectorType==="video"?o.selectedVideo?[o.selectedVideo]:[]:o.selectedMedia,onClose:e[23]||(e[23]=s=>o.showMediaSelector=!1),onSelect:l.handleMediaSelect},null,8,["open","multiple","allowedTypes","currentSelection","onSelect"]),o.showUserSelector?(i(),n("div",we,[t("div",ke,[t("div",_e,[t("div",Ue,[e[60]||(e[60]=t("h3",{class:"text-lg font-semibold"},"–í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",-1)),t("button",{onClick:e[24]||(e[24]=s=>o.showUserSelector=!1),class:"text-muted-foreground hover:text-foreground"}," ‚úï ")]),t("div",Se,[c(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>o.userSearchQuery=s),type:"text",placeholder:"–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, username, telegram_id...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background",onInput:e[26]||(e[26]=(...s)=>l.debounceUserSearch&&l.debounceUserSearch(...s))},null,544),[[m,o.userSearchQuery]])])]),t("div",Me,[o.usersLoading?(i(),n("div",Te,[...e[61]||(e[61]=[t("p",{class:"text-muted-foreground"},"–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...",-1)])])):o.availableUsers.length===0?(i(),n("div",Ce,[...e[62]||(e[62]=[t("p",{class:"text-muted-foreground"},"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",-1)])])):(i(),n("div",Ve,[(i(!0),n(h,null,x(o.availableUsers,s=>(i(),n("label",{key:s.id,class:"flex items-center gap-3 p-3 hover:bg-muted/50 rounded-lg cursor-pointer"},[t("input",{type:"checkbox",value:s.id,checked:l.isUserSelected(s.id),onChange:b=>l.toggleUserSelection(s),class:"w-4 h-4"},null,40,Re),t("div",Ae,[t("div",Be,[w(a(s.first_name||"")+" "+a(s.last_name||"")+" ",1),s.username?(i(),n("span",Le,"@"+a(s.username),1)):p("",!0)]),t("div",Pe,"ID: "+a(s.telegram_id),1)])]))),128))]))]),t("div",je,[t("div",Ie,[t("span",We," –í—ã–±—Ä–∞–Ω–æ: "+a(o.selectedUsers.length),1),t("button",{onClick:e[27]||(e[27]=s=>o.showUserSelector=!1),class:"px-4 py-2 bg-accent/10 text-accent border border-accent/40 hover:bg-accent/20 rounded-lg transition-colors"}," –ì–æ—Ç–æ–≤–æ ")])])])])):p("",!0)])}const Ee=_(R,[["render",ze]]);export{Ee as default};
