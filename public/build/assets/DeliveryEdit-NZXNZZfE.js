import{g as v}from"./api-BrgWxvgT.js";import{_ as x,c as s,o as n,a as r,b as a,f as g,t as m,g as f,r as _,e as u,d as l,C as y,A as k,v as i,p as c,w}from"./admin-Dbz-L3Lt.js";const V={name:"DeliveryEdit",data(){return{delivery:null,form:{delivery_type:"courier",status:"pending",courier_name:"",courier_phone:"",delivery_address:"",delivery_date:"",delivery_time_from:"",delivery_time_to:"",delivery_cost:0,tracking_number:"",notes:""},errors:{},loading:!1,error:null}},mounted(){this.loadDelivery()},methods:{async loadDelivery(){this.loading=!0,this.error=null;try{const d=this.$route.params.id,e=await v.getById(d);this.delivery=e.data,this.form={delivery_type:this.delivery.delivery_type||"courier",status:this.delivery.status||"pending",courier_name:this.delivery.courier_name||"",courier_phone:this.delivery.courier_phone||"",delivery_address:this.delivery.delivery_address||"",delivery_date:this.delivery.delivery_date||"",delivery_time_from:this.delivery.delivery_time_from||"",delivery_time_to:this.delivery.delivery_time_to||"",delivery_cost:Number(this.delivery.delivery_cost)||0,tracking_number:this.delivery.tracking_number||"",notes:this.delivery.notes||""}}catch(d){this.error=d.message||"Ошибка загрузки доставки"}finally{this.loading=!1}},async handleSubmit(){this.errors={},this.loading=!0;try{const d=this.$route.params.id;await v.update(d,this.form),this.$router.push("/deliveries")}catch(d){const e=d.response?.data||{};e.errors?this.errors=e.errors:alert(d.message||"Ошибка обновления доставки")}finally{this.loading=!1}}}},h={class:"delivery-edit-page"},U={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},D={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},S={class:"text-destructive"},N={key:2,class:"bg-card rounded-lg border border-border p-6"},C=["value"],B={key:0,class:"mt-1 text-sm text-destructive"},E={class:"grid grid-cols-2 gap-4"},M={class:"grid grid-cols-3 gap-4"},A={class:"grid grid-cols-2 gap-4"},I={class:"flex items-center gap-4 pt-4 border-t border-border"},T=["disabled"];function q(d,e,z,P,o,p){const b=_("router-link");return n(),s("div",h,[e[29]||(e[29]=r("div",{class:"mb-6"},[r("h1",{class:"text-2xl font-bold text-foreground"},"Редактировать доставку"),r("p",{class:"text-muted-foreground mt-1"},"Изменение доставки")],-1)),o.loading&&!o.delivery?(n(),s("div",U,[...e[12]||(e[12]=[r("p",{class:"text-muted-foreground"},"Загрузка доставки...",-1)])])):o.error?(n(),s("div",D,[r("p",S,m(o.error),1),g(b,{to:"/deliveries",class:"mt-4 inline-block h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90"},{default:f(()=>[...e[13]||(e[13]=[u(" Вернуться к списку ",-1)])]),_:1})])):o.delivery?(n(),s("div",N,[r("form",{onSubmit:e[11]||(e[11]=w((...t)=>p.handleSubmit&&p.handleSubmit(...t),["prevent"])),class:"space-y-6"},[r("div",null,[e[14]||(e[14]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},[u(" Заказ "),r("span",{class:"text-destructive"},"*")],-1)),r("input",{value:o.delivery.order?.order_id||o.delivery.order_id,type:"text",disabled:"",class:"w-full h-10 px-3 rounded-lg border border-input bg-muted text-muted-foreground"},null,8,C)]),r("div",null,[e[16]||(e[16]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Тип доставки",-1)),l(r("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>o.form.delivery_type=t),class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},[...e[15]||(e[15]=[r("option",{value:"courier"},"Курьер",-1),r("option",{value:"pickup"},"Самовывоз",-1),r("option",{value:"self_delivery"},"Своя доставка",-1)])],512),[[y,o.form.delivery_type]])]),r("div",null,[e[18]||(e[18]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Статус",-1)),l(r("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.form.status=t),class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},[...e[17]||(e[17]=[k('<option value="pending">Ожидает</option><option value="assigned">Назначена</option><option value="in_transit">В пути</option><option value="delivered">Доставлена</option><option value="failed">Ошибка</option><option value="returned">Возвращена</option>',6)])],512),[[y,o.form.status]])]),r("div",null,[e[19]||(e[19]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},[u(" Адрес доставки "),r("span",{class:"text-destructive"},"*")],-1)),l(r("textarea",{"onUpdate:modelValue":e[2]||(e[2]=t=>o.form.delivery_address=t),rows:"3",required:"",class:c(["w-full px-3 py-2 rounded-lg border border-input bg-background",{"border-destructive":o.errors.delivery_address}])},null,2),[[i,o.form.delivery_address]]),o.errors.delivery_address?(n(),s("p",B,m(o.errors.delivery_address),1)):a("",!0)]),r("div",E,[r("div",null,[e[20]||(e[20]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Имя курьера",-1)),l(r("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>o.form.courier_name=t),type:"text",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.courier_name]])]),r("div",null,[e[21]||(e[21]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Телефон курьера",-1)),l(r("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.form.courier_phone=t),type:"text",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.courier_phone]])])]),r("div",M,[r("div",null,[e[22]||(e[22]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Дата доставки",-1)),l(r("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>o.form.delivery_date=t),type:"date",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.delivery_date]])]),r("div",null,[e[23]||(e[23]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Время с",-1)),l(r("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>o.form.delivery_time_from=t),type:"time",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.delivery_time_from]])]),r("div",null,[e[24]||(e[24]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Время до",-1)),l(r("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>o.form.delivery_time_to=t),type:"time",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.delivery_time_to]])])]),r("div",A,[r("div",null,[e[25]||(e[25]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Стоимость доставки",-1)),l(r("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>o.form.delivery_cost=t),type:"number",step:"0.01",min:"0",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.delivery_cost,void 0,{number:!0}]])]),r("div",null,[e[26]||(e[26]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Трек-номер",-1)),l(r("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>o.form.tracking_number=t),type:"text",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[i,o.form.tracking_number]])])]),r("div",null,[e[27]||(e[27]=r("label",{class:"block text-sm font-medium text-foreground mb-2"},"Заметки",-1)),l(r("textarea",{"onUpdate:modelValue":e[10]||(e[10]=t=>o.form.notes=t),rows:"3",class:"w-full px-3 py-2 rounded-lg border border-input bg-background"},null,512),[[i,o.form.notes]])]),r("div",I,[r("button",{type:"submit",disabled:o.loading,class:"h-10 px-6 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"},m(o.loading?"Сохранение...":"Сохранить изменения"),9,T),g(b,{to:"/deliveries",class:"h-10 px-6 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:f(()=>[...e[28]||(e[28]=[u(" Отмена ",-1)])]),_:1})])],32)])):a("",!0)])}const G=x(V,[["render",q]]);export{G as default};
