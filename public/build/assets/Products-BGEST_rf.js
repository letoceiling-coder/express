import{p as b,e as v}from"./api-B1xjBEgk.js";import{_ as k,c as r,o,a as e,f as x,g,r as w,d as u,v as C,C as p,F as y,q as h,t as a,b as f,p as F,e as _}from"./admin-5oYsVZzx.js";const B={name:"Products",data(){return{products:[],categories:[],loading:!1,error:null,searchQuery:"",categoryFilter:"",statusFilter:"",sortBy:"sort_order"}},computed:{filteredProducts(){let t=[...Array.isArray(this.products)?this.products:[]];if(this.searchQuery){const l=this.searchQuery.toLowerCase();t=t.filter(n=>n.name.toLowerCase().includes(l)||n.sku&&n.sku.toLowerCase().includes(l)||n.barcode&&n.barcode.toLowerCase().includes(l))}if(this.categoryFilter&&(t=t.filter(l=>l.category_id&&Number(l.category_id)===Number(this.categoryFilter))),this.statusFilter!==""){const l=this.statusFilter==="true";t=t.filter(n=>n.is_available===l)}return t.sort((l,n)=>this.sortBy==="sort_order"?(l.sort_order||0)-(n.sort_order||0):this.sortBy==="name"?l.name.localeCompare(n.name):this.sortBy==="price"?Number(l.price)-Number(n.price):this.sortBy==="created_at"?new Date(n.created_at)-new Date(l.created_at):0),t}},mounted(){this.loadProducts(),this.loadCategories()},methods:{async loadProducts(){this.loading=!0,this.error=null;try{const d=await b.getAll();this.products=Array.isArray(d.data)?d.data:[]}catch(d){this.error=d.message||"Ошибка загрузки товаров",this.products=[]}finally{this.loading=!1}},async loadCategories(){try{const d=await v.getAll();this.categories=d.data||[]}catch(d){console.error("Ошибка загрузки категорий:",d)}},async handleDelete(d){if(confirm(`Вы уверены, что хотите удалить товар "${d.name}"?`))try{await b.delete(d.id),await this.loadProducts()}catch(t){alert(t.message||"Ошибка удаления товара")}}}},N={class:"products-page"},P={class:"mb-6 flex items-center justify-between"},A={class:"bg-card rounded-lg border border-border p-4 mb-6"},V={class:"flex gap-4 items-end flex-wrap"},L={class:"flex-1 min-w-[200px]"},D=["value"],U={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},Q={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},j={class:"text-destructive"},S={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},q={class:"w-full"},I={class:"divide-y divide-border"},M={class:"px-6 py-4"},R=["src","alt"],T={key:1,class:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center"},z={class:"px-6 py-4"},E={class:"font-medium text-foreground"},G={key:0,class:"text-sm text-muted-foreground"},H={class:"px-6 py-4"},J={key:0,class:"text-sm text-foreground"},K={key:1,class:"text-sm text-muted-foreground"},O={class:"px-6 py-4"},W={class:"text-sm text-foreground"},X={class:"px-6 py-4"},Y={class:"text-sm font-medium text-foreground"},Z={key:0,class:"text-xs text-muted-foreground line-through"},$={class:"px-6 py-4"},ee={class:"text-sm text-foreground"},te={class:"px-6 py-4"},se={class:"px-6 py-4 text-right"},re={class:"flex items-center justify-end gap-2"},oe=["onClick"],le={key:0,class:"p-12 text-center"};function de(d,t,l,n,i,c){const m=w("router-link");return o(),r("div",N,[e("div",P,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-2xl font-bold text-foreground"},"Товары"),e("p",{class:"text-muted-foreground mt-1"},"Управление товарами")],-1)),x(m,{to:"/products/create",class:"h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 inline-flex items-center gap-2"},{default:g(()=>[...t[4]||(t[4]=[e("span",null,"+",-1),e("span",null,"Создать товар",-1)])]),_:1})]),e("div",A,[e("div",V,[e("div",L,[t[6]||(t[6]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Поиск",-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.searchQuery=s),type:"text",placeholder:"Поиск по названию, артикулу, штрих-коду...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[C,i.searchQuery]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Категория",-1)),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.categoryFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[t[7]||(t[7]=e("option",{value:""},"Все категории",-1)),(o(!0),r(y,null,h(i.categories,s=>(o(),r("option",{key:s.id,value:s.id},a(s.name),9,D))),128))],512),[[p,i.categoryFilter]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Статус",-1)),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.statusFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[9]||(t[9]=[e("option",{value:""},"Все",-1),e("option",{value:"true"},"Доступны",-1),e("option",{value:"false"},"Недоступны",-1)])],512),[[p,i.statusFilter]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Сортировка",-1)),u(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>i.sortBy=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[11]||(t[11]=[e("option",{value:"sort_order"},"По порядку",-1),e("option",{value:"name"},"По названию",-1),e("option",{value:"price"},"По цене",-1),e("option",{value:"created_at"},"По дате",-1)])],512),[[p,i.sortBy]])])])]),i.loading?(o(),r("div",U,[...t[13]||(t[13]=[e("p",{class:"text-muted-foreground"},"Загрузка товаров...",-1)])])):i.error?(o(),r("div",Q,[e("p",j,a(i.error),1)])):(o(),r("div",S,[e("table",q,[t[17]||(t[17]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Изображение"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Название"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Категория"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Артикул"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Цена"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Остаток"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Статус"),e("th",{class:"px-6 py-3 text-right text-sm font-medium text-foreground"},"Действия")])],-1)),e("tbody",I,[(o(!0),r(y,null,h(c.filteredProducts,s=>(o(),r("tr",{key:s.id},[e("td",M,[s.image?.url?(o(),r("img",{key:0,src:s.image.url,alt:s.name,class:"w-16 h-16 object-cover rounded-lg"},null,8,R)):(o(),r("div",T,[...t[14]||(t[14]=[e("span",{class:"text-muted-foreground text-xs"},"Нет фото",-1)])]))]),e("td",z,[e("div",E,a(s.name),1),s.slug?(o(),r("div",G,a(s.slug),1)):f("",!0)]),e("td",H,[s.category?(o(),r("span",J,a(s.category.name),1)):(o(),r("span",K,"—"))]),e("td",O,[e("span",W,a(s.sku||"—"),1)]),e("td",X,[e("div",Y,a(Number(s.price).toLocaleString("ru-RU"))+" ₽ ",1),s.compare_price?(o(),r("div",Z,a(Number(s.compare_price).toLocaleString("ru-RU"))+" ₽ ",1)):f("",!0)]),e("td",$,[e("span",ee,a(s.stock_quantity||0),1)]),e("td",te,[e("span",{class:F([s.is_available?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 rounded-full text-xs font-medium"])},a(s.is_available?"Доступен":"Недоступен"),3)]),e("td",se,[e("div",re,[x(m,{to:`/products/${s.id}/edit`,class:"h-8 px-3 text-sm bg-accent/10 text-accent rounded-lg hover:bg-accent/20"},{default:g(()=>[...t[15]||(t[15]=[_(" Редактировать ",-1)])]),_:1},8,["to"]),x(m,{to:`/products/${s.id}/history`,class:"h-8 px-3 text-sm bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:g(()=>[...t[16]||(t[16]=[_(" История ",-1)])]),_:1},8,["to"]),e("button",{onClick:ne=>c.handleDelete(s),class:"h-8 px-3 text-sm bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Удалить ",8,oe)])])]))),128))])]),c.filteredProducts.length===0?(o(),r("div",le,[...t[18]||(t[18]=[e("p",{class:"text-muted-foreground"},"Товары не найдены",-1)])])):f("",!0)]))])}const ue=k(B,[["render",de]]);export{ue as default};
