import{e as x}from"./api-CFyaGjRO.js";import{M as v}from"./MediaSelector-DGGEY3VA.js";import{s as y}from"./swal-C5DxUZ5S.js";import{_ as h,c as l,o as n,a as t,f as u,w,d,b as a,e as g,v as m,p as k,t as p,D as S,g as M,r as c}from"./admin-UUxYMKVo.js";import"./Media-Cz-Q8SXn.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const C={name:"CategoryCreate",components:{MediaSelector:v},data(){return{form:{name:"",description:"",image_id:null,sort_order:0,is_active:!0},errors:{},loading:!1,showMediaSelector:!1,selectedImage:null}},methods:{async handleSubmit(){this.errors={},this.loading=!0;try{if(!this.form.name||this.form.name.length<2){this.errors.name="Название должно содержать минимум 2 символа",this.loading=!1;return}await x.create(this.form),this.$router.push("/categories")}catch(s){const e=s.response?.data||{};e.errors?this.errors=e.errors:await y.error(s.message||"Ошибка создания категории")}finally{this.loading=!1}},handleMediaSelected(s){this.selectedImage=s,this.form.image_id=s.id,this.showMediaSelector=!1}}},I={class:"category-create-page"},V={class:"bg-card rounded-lg border border-border p-6"},_={key:0,class:"mt-1 text-sm text-destructive"},D={class:"flex items-center gap-4"},N=["src"],U={key:1,class:"w-32 h-32 bg-muted rounded-lg flex items-center justify-center"},B={class:"flex items-center gap-2 cursor-pointer"},T={class:"flex items-center gap-4 pt-4 border-t border-border"},j=["disabled"];function P(s,e,q,z,r,i){const b=c("router-link"),f=c("MediaSelector");return n(),l("div",I,[e[16]||(e[16]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-foreground"},"Создать категорию"),t("p",{class:"text-muted-foreground mt-1"},"Добавление новой категории товаров")],-1)),t("div",V,[t("form",{onSubmit:e[6]||(e[6]=w((...o)=>i.handleSubmit&&i.handleSubmit(...o),["prevent"])),class:"space-y-6"},[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},[g(" Название "),t("span",{class:"text-destructive"},"*")],-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.form.name=o),type:"text",required:"",minlength:"2",class:k(["w-full h-10 px-3 rounded-lg border border-input bg-background",{"border-destructive":r.errors.name}])},null,2),[[m,r.form.name]]),r.errors.name?(n(),l("p",_,p(r.errors.name),1)):a("",!0)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Описание",-1)),d(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.form.description=o),rows:"4",class:"w-full px-3 py-2 rounded-lg border border-input bg-background"},null,512),[[m,r.form.description]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Изображение",-1)),t("div",D,[r.selectedImage?(n(),l("img",{key:0,src:r.selectedImage.url,alt:"Preview",class:"w-32 h-32 object-cover rounded-lg border border-border"},null,8,N)):(n(),l("div",U,[...e[10]||(e[10]=[t("span",{class:"text-muted-foreground text-sm"},"Нет изображения",-1)])])),t("div",null,[t("button",{type:"button",onClick:e[2]||(e[2]=o=>r.showMediaSelector=!0),class:"h-10 px-4 bg-accent/10 text-accent rounded-lg hover:bg-accent/20"}," Выбрать из медиа "),r.selectedImage?(n(),l("button",{key:0,type:"button",onClick:e[3]||(e[3]=o=>{r.selectedImage=null,r.form.image_id=null}),class:"ml-2 h-10 px-4 bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Удалить ")):a("",!0)])]),e[12]||(e[12]=t("p",{class:"mt-2 text-sm text-muted-foreground"},"Выберите изображение из медиа-библиотеки",-1))]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-foreground mb-2"},"Порядок сортировки",-1)),d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.form.sort_order=o),type:"number",min:"0",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[m,r.form.sort_order,void 0,{number:!0}]])]),t("div",null,[t("label",B,[d(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.form.is_active=o),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[S,r.form.is_active]]),e[14]||(e[14]=t("span",{class:"text-sm font-medium text-foreground"},"Категория активна",-1))])]),t("div",T,[t("button",{type:"submit",disabled:r.loading,class:"h-10 px-6 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"},p(r.loading?"Создание...":"Создать категорию"),9,j),u(b,{to:"/categories",class:"h-10 px-6 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:M(()=>[...e[15]||(e[15]=[g(" Отмена ",-1)])]),_:1})])],32)]),u(f,{open:r.showMediaSelector,multiple:!1,allowedTypes:["photo"],currentSelection:r.selectedImage?[r.selectedImage]:[],onClose:e[7]||(e[7]=o=>r.showMediaSelector=!1),onSelect:i.handleMediaSelected},null,8,["open","currentSelection","onSelect"])])}const K=h(C,[["render",P]]);export{K as default};
