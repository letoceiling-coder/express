import{c as g}from"./api-Ck1hP3IQ.js";import{s as c}from"./swal-C5DxUZ5S.js";import{_ as v,c as d,o as i,a as o,w as y,d as s,b as u,e as p,v as l,p as b,t as a,D as m,C as _,f as k,g as w,r as V}from"./admin-CKq40Ele.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const U={name:"PaymentMethodCreate",data(){return{form:{code:"",name:"",description:"",is_enabled:!0,is_default:!1,available_for_delivery:!0,available_for_pickup:!0,sort_order:0,discount_type:"none",discount_value:null,min_cart_amount:null,show_notification:!1,notification_text:""},errors:{},loading:!1}},methods:{async handleSubmit(){this.errors={},this.loading=!0;try{const n={...this.form};n.discount_type==="none"&&(n.discount_value=null,n.min_cart_amount=null),n.show_notification||(n.notification_text=null),await g("/payment-methods",n),this.$router.push("/payment-methods")}catch(n){n.response?.data?.errors?this.errors=n.response.data.errors:await c.error(n.response?.data?.message||"Ошибка создания способа оплаты")}finally{this.loading=!1}}}},C={class:"payment-method-create-page"},h={class:"bg-card rounded-lg border border-border p-6"},M={class:"space-y-4"},S={key:0,class:"mt-1 text-sm text-destructive"},D={key:0,class:"mt-1 text-sm text-destructive"},N={class:"flex items-center gap-2 cursor-pointer"},q={class:"flex items-center gap-2 cursor-pointer"},B={class:"space-y-4 pt-6 border-t border-border"},P={class:"flex items-center gap-2 cursor-pointer"},z={class:"flex items-center gap-2 cursor-pointer"},T={class:"space-y-4 pt-6 border-t border-border"},E={key:0},j={class:"flex items-center gap-2"},A=["placeholder"],F={class:"text-sm text-muted-foreground"},G={key:1},H={class:"space-y-4 pt-6 border-t border-border"},I={class:"flex items-center gap-2 cursor-pointer"},J={key:0},K={class:"flex items-center gap-4 pt-4 border-t border-border"},L=["disabled"];function O(n,e,Q,R,t,f){const x=V("router-link");return i(),d("div",C,[e[36]||(e[36]=o("div",{class:"mb-6"},[o("h1",{class:"text-2xl font-bold text-foreground"},"Создать способ оплаты"),o("p",{class:"text-muted-foreground mt-1"},"Добавление нового способа оплаты")],-1)),o("div",h,[o("form",{onSubmit:e[13]||(e[13]=y((...r)=>f.handleSubmit&&f.handleSubmit(...r),["prevent"])),class:"space-y-6"},[o("div",M,[e[21]||(e[21]=o("h2",{class:"text-lg font-semibold text-foreground"},"Основная информация",-1)),o("div",null,[e[14]||(e[14]=o("label",{class:"block text-sm font-medium text-foreground mb-2"},[p(" Код "),o("span",{class:"text-destructive"},"*")],-1)),s(o("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>t.form.code=r),type:"text",required:"",pattern:"[a-z0-9_]+",placeholder:"yookassa, cash, etc.",class:b(["w-full h-10 px-3 rounded-lg border border-input bg-background",{"border-destructive":t.errors.code}])},null,2),[[l,t.form.code]]),t.errors.code?(i(),d("p",S,a(t.errors.code),1)):u("",!0),e[15]||(e[15]=o("p",{class:"mt-1 text-xs text-muted-foreground"},"Только строчные буквы, цифры и подчеркивание",-1))]),o("div",null,[e[16]||(e[16]=o("label",{class:"block text-sm font-medium text-foreground mb-2"},[p(" Название "),o("span",{class:"text-destructive"},"*")],-1)),s(o("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>t.form.name=r),type:"text",required:"",class:b(["w-full h-10 px-3 rounded-lg border border-input bg-background",{"border-destructive":t.errors.name}])},null,2),[[l,t.form.name]]),t.errors.name?(i(),d("p",D,a(t.errors.name),1)):u("",!0)]),o("div",null,[e[17]||(e[17]=o("label",{class:"block text-sm font-medium text-foreground mb-2"},"Описание",-1)),s(o("textarea",{"onUpdate:modelValue":e[2]||(e[2]=r=>t.form.description=r),rows:"3",class:"w-full px-3 py-2 rounded-lg border border-input bg-background"},null,512),[[l,t.form.description]])]),o("div",null,[e[18]||(e[18]=o("label",{class:"block text-sm font-medium text-foreground mb-2"},"Порядок сортировки",-1)),s(o("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>t.form.sort_order=r),type:"number",min:"0",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[l,t.form.sort_order,void 0,{number:!0}]])]),o("div",null,[o("label",N,[s(o("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>t.form.is_enabled=r),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[m,t.form.is_enabled]]),e[19]||(e[19]=o("span",{class:"text-sm font-medium text-foreground"},"Способ оплаты активен",-1))])]),o("div",null,[o("label",q,[s(o("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>t.form.is_default=r),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[m,t.form.is_default]]),e[20]||(e[20]=o("span",{class:"text-sm font-medium text-foreground"},"По умолчанию (будет выбран автоматически)",-1))])])]),o("div",B,[e[24]||(e[24]=o("h2",{class:"text-lg font-semibold text-foreground"},"Доступность оплаты",-1)),o("div",null,[o("label",P,[s(o("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>t.form.available_for_delivery=r),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[m,t.form.available_for_delivery]]),e[22]||(e[22]=o("span",{class:"text-sm font-medium text-foreground"},"Доступен при доставке",-1))])]),o("div",null,[o("label",z,[s(o("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>t.form.available_for_pickup=r),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[m,t.form.available_for_pickup]]),e[23]||(e[23]=o("span",{class:"text-sm font-medium text-foreground"},"Доступен при самовывозе",-1))])])]),o("div",T,[e[30]||(e[30]=o("h2",{class:"text-lg font-semibold text-foreground"},"Настройки скидки",-1)),o("div",null,[e[26]||(e[26]=o("label",{class:"block text-sm font-medium text-foreground mb-2"},"Тип скидки",-1)),s(o("select",{"onUpdate:modelValue":e[8]||(e[8]=r=>t.form.discount_type=r),class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},[...e[25]||(e[25]=[o("option",{value:"none"},"Нет скидки",-1),o("option",{value:"percentage"},"Процент от суммы корзины",-1),o("option",{value:"fixed"},"Фиксированная сумма",-1)])],512),[[_,t.form.discount_type]])]),t.form.discount_type!=="none"?(i(),d("div",E,[e[27]||(e[27]=o("label",{class:"block text-sm font-medium text-foreground mb-2"},[p(" Значение скидки "),o("span",{class:"text-destructive"},"*")],-1)),o("div",j,[s(o("input",{"onUpdate:modelValue":e[9]||(e[9]=r=>t.form.discount_value=r),type:"number",step:"0.01",min:"0",required:"",placeholder:t.form.discount_type==="percentage"?"3":"100",class:"flex-1 h-10 px-3 rounded-lg border border-input bg-background"},null,8,A),[[l,t.form.discount_value,void 0,{number:!0}]]),o("span",F,a(t.form.discount_type==="percentage"?"%":"₽"),1)])])):u("",!0),t.form.discount_type!=="none"?(i(),d("div",G,[e[28]||(e[28]=o("label",{class:"block text-sm font-medium text-foreground mb-2"}," Минимальная сумма корзины (₽) ",-1)),s(o("input",{"onUpdate:modelValue":e[10]||(e[10]=r=>t.form.min_cart_amount=r),type:"number",step:"0.01",min:"0",placeholder:"2000",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[l,t.form.min_cart_amount,void 0,{number:!0}]]),e[29]||(e[29]=o("p",{class:"mt-1 text-xs text-muted-foreground"}," Скидка будет применяться только если сумма корзины превышает указанное значение ",-1))])):u("",!0)]),o("div",H,[e[34]||(e[34]=o("h2",{class:"text-lg font-semibold text-foreground"},"Уведомление пользователя",-1)),o("div",null,[o("label",I,[s(o("input",{"onUpdate:modelValue":e[11]||(e[11]=r=>t.form.show_notification=r),type:"checkbox",class:"w-4 h-4 rounded border-input"},null,512),[[m,t.form.show_notification]]),e[31]||(e[31]=o("span",{class:"text-sm font-medium text-foreground"},"Показывать уведомление при выборе",-1))])]),t.form.show_notification?(i(),d("div",J,[e[32]||(e[32]=o("label",{class:"block text-sm font-medium text-foreground mb-2"},"Текст уведомления",-1)),s(o("textarea",{"onUpdate:modelValue":e[12]||(e[12]=r=>t.form.notification_text=r),rows:"3",placeholder:"При оплате через {name} вы получите скидку {discount_percent}% ({discount} ₽). Итого к оплате: {final_amount} ₽",class:"w-full px-3 py-2 rounded-lg border border-input bg-background"},null,512),[[l,t.form.notification_text]]),e[33]||(e[33]=o("p",{class:"mt-1 text-xs text-muted-foreground"}," Доступные плейсхолдеры: {name}, {discount}, {discount_percent}, {final_amount}, {cart_amount} ",-1))])):u("",!0)]),o("div",K,[o("button",{type:"submit",disabled:t.loading,class:"h-10 px-6 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"},a(t.loading?"Создание...":"Создать способ оплаты"),9,L),k(x,{to:"/payment-methods",class:"h-10 px-6 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:w(()=>[...e[35]||(e[35]=[p(" Отмена ",-1)])]),_:1})])],32)])])}const $=v(U,[["render",O]]);export{$ as default};
