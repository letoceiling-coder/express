import{p,e as _}from"./api-zu2yNUu0.js";import{_ as v,c as o,o as l,a as e,f as c,g as x,r as k,d as a,v as w,C as g,F as b,q as y,t as i,b as f,p as C,e as h}from"./admin-DFff7eEE.js";const F={name:"Products",data(){return{products:[],categories:[],loading:!1,error:null,searchQuery:"",categoryFilter:"",statusFilter:"",sortBy:"sort_order"}},computed:{filteredProducts(){let r=[...this.products];if(this.searchQuery){const t=this.searchQuery.toLowerCase();r=r.filter(d=>d.name.toLowerCase().includes(t)||d.sku&&d.sku.toLowerCase().includes(t)||d.barcode&&d.barcode.toLowerCase().includes(t))}if(this.categoryFilter&&(r=r.filter(t=>t.category_id&&Number(t.category_id)===Number(this.categoryFilter))),this.statusFilter!==""){const t=this.statusFilter==="true";r=r.filter(d=>d.is_available===t)}return r.sort((t,d)=>this.sortBy==="sort_order"?(t.sort_order||0)-(d.sort_order||0):this.sortBy==="name"?t.name.localeCompare(d.name):this.sortBy==="price"?Number(t.price)-Number(d.price):this.sortBy==="created_at"?new Date(d.created_at)-new Date(t.created_at):0),r}},mounted(){this.loadProducts(),this.loadCategories()},methods:{async loadProducts(){this.loading=!0,this.error=null;try{const r=await p.getAll();this.products=r.data||[]}catch(r){this.error=r.message||"Ошибка загрузки товаров"}finally{this.loading=!1}},async loadCategories(){try{const r=await _.getAll();this.categories=r.data||[]}catch(r){console.error("Ошибка загрузки категорий:",r)}},async handleDelete(r){if(confirm(`Вы уверены, что хотите удалить товар "${r.name}"?`))try{await p.delete(r.id),await this.loadProducts()}catch(t){alert(t.message||"Ошибка удаления товара")}}}},B={class:"products-page"},N={class:"mb-6 flex items-center justify-between"},P={class:"bg-card rounded-lg border border-border p-4 mb-6"},V={class:"flex gap-4 items-end flex-wrap"},L={class:"flex-1 min-w-[200px]"},D=["value"],U={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},A={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},Q={class:"text-destructive"},j={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},S={class:"w-full"},q={class:"divide-y divide-border"},I={class:"px-6 py-4"},M=["src","alt"],R={key:1,class:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center"},T={class:"px-6 py-4"},z={class:"font-medium text-foreground"},E={key:0,class:"text-sm text-muted-foreground"},G={class:"px-6 py-4"},H={key:0,class:"text-sm text-foreground"},J={key:1,class:"text-sm text-muted-foreground"},K={class:"px-6 py-4"},O={class:"text-sm text-foreground"},W={class:"px-6 py-4"},X={class:"text-sm font-medium text-foreground"},Y={key:0,class:"text-xs text-muted-foreground line-through"},Z={class:"px-6 py-4"},$={class:"text-sm text-foreground"},ee={class:"px-6 py-4"},te={class:"px-6 py-4 text-right"},se={class:"flex items-center justify-end gap-2"},re=["onClick"],oe={key:0,class:"p-12 text-center"};function le(r,t,d,de,n,u){const m=k("router-link");return l(),o("div",B,[e("div",N,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-2xl font-bold text-foreground"},"Товары"),e("p",{class:"text-muted-foreground mt-1"},"Управление товарами")],-1)),c(m,{to:"/products/create",class:"h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 inline-flex items-center gap-2"},{default:x(()=>[...t[4]||(t[4]=[e("span",null,"+",-1),e("span",null,"Создать товар",-1)])]),_:1})]),e("div",P,[e("div",V,[e("div",L,[t[6]||(t[6]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Поиск",-1)),a(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.searchQuery=s),type:"text",placeholder:"Поиск по названию, артикулу, штрих-коду...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[w,n.searchQuery]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Категория",-1)),a(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.categoryFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[t[7]||(t[7]=e("option",{value:""},"Все категории",-1)),(l(!0),o(b,null,y(n.categories,s=>(l(),o("option",{key:s.id,value:s.id},i(s.name),9,D))),128))],512),[[g,n.categoryFilter]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Статус",-1)),a(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.statusFilter=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[9]||(t[9]=[e("option",{value:""},"Все",-1),e("option",{value:"true"},"Доступны",-1),e("option",{value:"false"},"Недоступны",-1)])],512),[[g,n.statusFilter]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Сортировка",-1)),a(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.sortBy=s),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...t[11]||(t[11]=[e("option",{value:"sort_order"},"По порядку",-1),e("option",{value:"name"},"По названию",-1),e("option",{value:"price"},"По цене",-1),e("option",{value:"created_at"},"По дате",-1)])],512),[[g,n.sortBy]])])])]),n.loading?(l(),o("div",U,[...t[13]||(t[13]=[e("p",{class:"text-muted-foreground"},"Загрузка товаров...",-1)])])):n.error?(l(),o("div",A,[e("p",Q,i(n.error),1)])):(l(),o("div",j,[e("table",S,[t[17]||(t[17]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Изображение"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Название"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Категория"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Артикул"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Цена"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Остаток"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Статус"),e("th",{class:"px-6 py-3 text-right text-sm font-medium text-foreground"},"Действия")])],-1)),e("tbody",q,[(l(!0),o(b,null,y(u.filteredProducts,s=>(l(),o("tr",{key:s.id},[e("td",I,[s.image?.url?(l(),o("img",{key:0,src:s.image.url,alt:s.name,class:"w-16 h-16 object-cover rounded-lg"},null,8,M)):(l(),o("div",R,[...t[14]||(t[14]=[e("span",{class:"text-muted-foreground text-xs"},"Нет фото",-1)])]))]),e("td",T,[e("div",z,i(s.name),1),s.slug?(l(),o("div",E,i(s.slug),1)):f("",!0)]),e("td",G,[s.category?(l(),o("span",H,i(s.category.name),1)):(l(),o("span",J,"—"))]),e("td",K,[e("span",O,i(s.sku||"—"),1)]),e("td",W,[e("div",X,i(Number(s.price).toLocaleString("ru-RU"))+" ₽ ",1),s.compare_price?(l(),o("div",Y,i(Number(s.compare_price).toLocaleString("ru-RU"))+" ₽ ",1)):f("",!0)]),e("td",Z,[e("span",$,i(s.stock_quantity||0),1)]),e("td",ee,[e("span",{class:C([s.is_available?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 rounded-full text-xs font-medium"])},i(s.is_available?"Доступен":"Недоступен"),3)]),e("td",te,[e("div",se,[c(m,{to:`/products/${s.id}/edit`,class:"h-8 px-3 text-sm bg-accent/10 text-accent rounded-lg hover:bg-accent/20"},{default:x(()=>[...t[15]||(t[15]=[h(" Редактировать ",-1)])]),_:1},8,["to"]),c(m,{to:`/products/${s.id}/history`,class:"h-8 px-3 text-sm bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"},{default:x(()=>[...t[16]||(t[16]=[h(" История ",-1)])]),_:1},8,["to"]),e("button",{onClick:ne=>u.handleDelete(s),class:"h-8 px-3 text-sm bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Удалить ",8,re)])])]))),128))])]),u.filteredProducts.length===0?(l(),o("div",oe,[...t[18]||(t[18]=[e("p",{class:"text-muted-foreground"},"Товары не найдены",-1)])])):f("",!0)]))])}const ue=v(F,[["render",le]]);export{ue as default};
