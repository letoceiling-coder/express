import{e as p}from"./api-DA8AiDq_.js";import{s as g}from"./swal-C5DxUZ5S.js";import{_ as k,c as d,o as n,a as t,b as x,f as v,g as y,r as C,d as f,v as D,C as _,t as c,F as I,q as E,w as b,p as w,e as F}from"./admin-D0B_zdeG.js";import"./sweetalert2.esm.all-C0u8rGqG.js";const S={name:"Categories",data(){return{categories:[],loading:!1,error:null,searchQuery:"",statusFilter:"",sortBy:"sort_order",draggedIndex:null,draggedOverIndex:null,exporting:!1,showImportDialog:!1,selectedFile:null,importing:!1,importError:null,importSuccess:null}},computed:{filteredCategories(){let e=[...Array.isArray(this.categories)?this.categories:[]];if(this.searchQuery){const i=this.searchQuery.toLowerCase();e=e.filter(a=>a.name.toLowerCase().includes(i)||a.slug&&a.slug.toLowerCase().includes(i))}if(this.statusFilter!==""){const i=this.statusFilter==="true";e=e.filter(a=>a.is_active===i)}return e.sort((i,a)=>this.sortBy==="sort_order"?(i.sort_order||0)-(a.sort_order||0):this.sortBy==="name"?i.name.localeCompare(a.name):this.sortBy==="created_at"?new Date(a.created_at)-new Date(i.created_at):0),e}},mounted(){this.loadCategories()},methods:{async loadCategories(){this.loading=!0,this.error=null;try{const s=await p.getAll();let e=Array.isArray(s.data)?s.data:[];e.sort((i,a)=>{const r=i.sort_order||0,l=a.sort_order||0;return r!==l?r-l:i.name.localeCompare(a.name)}),this.categories=e}catch(s){this.error=s.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹",this.categories=[]}finally{this.loading=!1}},async handleDelete(s){if((await g.confirm(`Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ "${s.name}"?`,"Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸","Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ","ÐžÑ‚Ð¼ÐµÐ½Ð°")).isConfirmed)try{await p.delete(s.id),await this.loadCategories(),await g.success("ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑƒÐ´Ð°Ð»ÐµÐ½Ð°")}catch(i){await g.error(i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸")}},handleDragStart(s,e){this.draggedIndex=e,s.dataTransfer.effectAllowed="move",s.dataTransfer.setData("text/html",s.target)},handleDragOver(s,e){s.preventDefault(),this.draggedOverIndex=e},handleDragLeave(s){s.currentTarget.contains(s.relatedTarget)||(this.draggedOverIndex=null)},async handleDrop(s,e){if(s.preventDefault(),this.draggedIndex===null||this.draggedIndex===e){this.draggedIndex=null,this.draggedOverIndex=null;return}const i=[...this.categories],a=i[this.draggedIndex];i.splice(this.draggedIndex,1),i.splice(e,0,a);const r=i.map((l,h)=>({...l,sort_order:h}));this.categories=r,this.draggedIndex=null,this.draggedOverIndex=null;try{await p.updatePositions(r.map(l=>({id:l.id,sort_order:l.sort_order||0}))),console.log("ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½")}catch(l){console.error("Failed to update positions:",l),await g.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ð¸ Ð¿Ð¾Ñ€ÑÐ´ÐºÐ° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹"),await this.loadCategories()}},handleDragEnd(){this.draggedIndex=null,this.draggedOverIndex=null},async handleExportCsv(){this.exporting=!0;try{await p.exportCsv(),await g.success("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² CSV Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(s){await g.error(s.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² CSV")}finally{this.exporting=!1}},async handleExportExcel(){this.exporting=!0;try{await p.exportExcel(),await g.success("Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² Excel Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾")}catch(s){await g.error(s.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð² Excel")}finally{this.exporting=!1}},handleFileSelect(s){this.selectedFile=s.target.files[0]||null,this.importError=null,this.importSuccess=null},async handleImport(){if(!this.selectedFile){this.importError="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð°";return}this.importing=!0,this.importError=null,this.importSuccess=null;try{const s=await p.import(this.selectedFile);this.importSuccess=s.message||"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹",await this.loadCategories(),setTimeout(()=>{this.showImportDialog=!1,this.selectedFile=null,this.$refs.importFileInput&&(this.$refs.importFileInput.value=""),this.importSuccess=null},2e3)}catch(s){this.importError=s.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹"}finally{this.importing=!1}}}},B={class:"categories-page"},V={class:"mb-6 flex items-center justify-between"},A={class:"flex items-center gap-2"},O=["disabled"],T={key:0},j={key:1},L=["disabled"],Q={key:0},M={key:1},N={class:"bg-card rounded-lg border border-border p-4 mb-6"},U={class:"flex gap-4 items-end"},q={class:"flex-1"},z={key:0,class:"bg-card rounded-lg border border-border p-12 text-center"},P={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-4"},G={class:"text-destructive"},H={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},J={class:"w-full"},K={class:"divide-y divide-border"},R=["onDragstart","onDragover","onDrop"],W={class:"px-6 py-4"},X=["src","alt"],Y={key:1,class:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center"},Z={class:"px-6 py-4"},$={class:"font-medium text-foreground"},ee={key:0,class:"text-sm text-muted-foreground"},te={class:"px-6 py-4"},re={class:"text-sm text-muted-foreground line-clamp-2"},se={class:"px-6 py-4"},oe={class:"text-sm text-foreground"},le={class:"px-6 py-4"},ie={class:"px-6 py-4 text-right"},de={class:"flex items-center justify-end gap-2"},ne=["onClick"],ae={key:0,class:"p-12 text-center"},ue={class:"bg-card rounded-lg border border-border p-6 max-w-md w-full mx-4"},ge={class:"space-y-4"},ce={key:0,class:"bg-destructive/10 border border-destructive/20 rounded-lg p-3"},pe={class:"text-destructive text-sm"},me={key:1,class:"bg-green-100 border border-green-300 rounded-lg p-3"},xe={class:"text-green-800 text-sm"},he={class:"flex gap-2 mt-6"},fe=["disabled"],be={key:0},ve={key:1};function ye(s,e,i,a,r,l){const h=C("router-link");return n(),d("div",B,[t("div",V,[e[14]||(e[14]=t("div",null,[t("h1",{class:"text-2xl font-bold text-foreground"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸"),t("p",{class:"text-muted-foreground mt-1"},"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²")],-1)),t("div",A,[t("button",{onClick:e[0]||(e[0]=(...o)=>l.handleExportCsv&&l.handleExportCsv(...o)),class:"h-10 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(n(),d("span",T,"...")):(n(),d("span",j,"ðŸ“¥ CSV"))],8,O),t("button",{onClick:e[1]||(e[1]=(...o)=>l.handleExportExcel&&l.handleExportExcel(...o)),class:"h-10 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-flex items-center gap-2",disabled:r.exporting},[r.exporting?(n(),d("span",Q,"...")):(n(),d("span",M,"ðŸ“¥ Excel"))],8,L),t("button",{onClick:e[2]||(e[2]=o=>r.showImportDialog=!0),class:"h-10 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 inline-flex items-center gap-2"},[...e[12]||(e[12]=[t("span",null,"ðŸ“¤ Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚",-1)])]),v(h,{to:"/categories/create",class:"h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 inline-flex items-center gap-2"},{default:y(()=>[...e[13]||(e[13]=[t("span",null,"+",-1),t("span",null,"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ",-1)])]),_:1})])]),t("div",N,[t("div",U,[t("div",q,[e[15]||(e[15]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"ÐŸÐ¾Ð¸ÑÐº",-1)),f(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.searchQuery=o),type:"text",placeholder:"ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ...",class:"w-full h-10 px-3 rounded-lg border border-input bg-background"},null,512),[[D,r.searchQuery]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ",-1)),f(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.statusFilter=o),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...e[16]||(e[16]=[t("option",{value:""},"Ð’ÑÐµ",-1),t("option",{value:"true"},"ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ",-1),t("option",{value:"false"},"ÐÐµÐ°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ",-1)])],512),[[_,r.statusFilter]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"text-sm font-medium text-foreground mb-1 block"},"Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°",-1)),f(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.sortBy=o),class:"h-10 px-3 rounded-lg border border-input bg-background"},[...e[18]||(e[18]=[t("option",{value:"sort_order"},"ÐŸÐ¾ Ð¿Ð¾Ñ€ÑÐ´ÐºÑƒ",-1),t("option",{value:"name"},"ÐŸÐ¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ",-1),t("option",{value:"created_at"},"ÐŸÐ¾ Ð´Ð°Ñ‚Ðµ",-1)])],512),[[_,r.sortBy]])])])]),r.loading?(n(),d("div",z,[...e[20]||(e[20]=[t("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹...",-1)])])):r.error?(n(),d("div",P,[t("p",G,c(r.error),1)])):(n(),d("div",H,[t("table",J,[e[24]||(e[24]=t("thead",{class:"bg-muted/50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground w-10"}),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº"),t("th",{class:"px-6 py-3 text-left text-sm font-medium text-foreground"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ"),t("th",{class:"px-6 py-3 text-right text-sm font-medium text-foreground"},"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ")])],-1)),t("tbody",K,[(n(!0),d(I,null,E(l.filteredCategories,(o,m)=>(n(),d("tr",{key:o.id,draggable:!0,onDragstart:u=>l.handleDragStart(u,m),onDragover:b(u=>l.handleDragOver(u,m),["prevent"]),onDragleave:e[6]||(e[6]=u=>l.handleDragLeave(u)),onDrop:b(u=>l.handleDrop(u,m),["prevent"]),onDragend:e[7]||(e[7]=(...u)=>l.handleDragEnd&&l.handleDragEnd(...u)),class:w([{"opacity-50":r.draggedIndex===m,"bg-blue-50 dark:bg-blue-900/20":r.draggedOverIndex===m},"cursor-move transition-colors"])},[e[23]||(e[23]=t("td",{class:"px-6 py-4 w-10"},[t("svg",{class:"w-5 h-5 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})])],-1)),t("td",W,[o.image?.url?(n(),d("img",{key:0,src:o.image.url,alt:o.name,class:"w-16 h-16 object-cover rounded-lg"},null,8,X)):(n(),d("div",Y,[...e[21]||(e[21]=[t("span",{class:"text-muted-foreground text-xs"},"ÐÐµÑ‚ Ñ„Ð¾Ñ‚Ð¾",-1)])]))]),t("td",Z,[t("div",$,c(o.name),1),o.slug?(n(),d("div",ee,c(o.slug),1)):x("",!0)]),t("td",te,[t("div",re,c(o.description||"â€”"),1)]),t("td",se,[t("span",oe,c(o.sort_order||0),1)]),t("td",le,[t("span",{class:w([o.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 rounded-full text-xs font-medium"])},c(o.is_active?"ÐÐºÑ‚Ð¸Ð²Ð½Ð°":"ÐÐµÐ°ÐºÑ‚Ð¸Ð²Ð½Ð°"),3)]),t("td",ie,[t("div",de,[v(h,{to:`/categories/${o.id}/edit`,class:"h-8 px-3 text-sm bg-accent/10 text-accent rounded-lg hover:bg-accent/20"},{default:y(()=>[...e[22]||(e[22]=[F(" Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ",-1)])]),_:1},8,["to"]),t("button",{onClick:u=>l.handleDelete(o),class:"h-8 px-3 text-sm bg-destructive/10 text-destructive rounded-lg hover:bg-destructive/20"}," Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ",8,ne)])])],42,R))),128))])]),l.filteredCategories.length===0?(n(),d("div",ae,[...e[25]||(e[25]=[t("p",{class:"text-muted-foreground"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹",-1)])])):x("",!0)])),r.showImportDialog?(n(),d("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:e[11]||(e[11]=b(o=>r.showImportDialog=!1,["self"]))},[t("div",ue,[e[27]||(e[27]=t("h2",{class:"text-xl font-bold text-foreground mb-4"},"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹",-1)),t("div",ge,[t("div",null,[e[26]||(e[26]=t("label",{class:"text-sm font-medium text-foreground mb-2 block"}," Ð¤Ð°Ð¹Ð» (CSV Ð¸Ð»Ð¸ Excel) ",-1)),t("input",{ref:"importFileInput",type:"file",accept:".csv,.xlsx,.xls",class:"w-full h-10 px-3 rounded-lg border border-input bg-background",onChange:e[8]||(e[8]=(...o)=>l.handleFileSelect&&l.handleFileSelect(...o))},null,544)]),r.importError?(n(),d("div",ce,[t("p",pe,c(r.importError),1)])):x("",!0),r.importSuccess?(n(),d("div",me,[t("p",xe,c(r.importSuccess),1)])):x("",!0)]),t("div",he,[t("button",{onClick:e[9]||(e[9]=o=>r.showImportDialog=!1),class:"flex-1 h-10 px-4 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80"}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),t("button",{onClick:e[10]||(e[10]=(...o)=>l.handleImport&&l.handleImport(...o)),class:"flex-1 h-10 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",disabled:r.importing||!r.selectedFile},[r.importing?(n(),d("span",be,"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚...")):(n(),d("span",ve,"Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"))],8,fe)])])])):x("",!0)])}const De=k(S,[["render",ye]]);export{De as default};
